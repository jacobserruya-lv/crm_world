<apex:page showheader="false" standardstylesheets="false" sidebar="false"
           cache="false" applyhtmltag="false" doctype="html-5.0"
           standardcontroller="Opportunity"
           extensions="SO_BriefOrder_CTRL"
           action="{! validateEnterance }"
>

    <apex:composition template="SO_Template">
        <apex:define name="headTag">
            <title>{!$Label.LV_SO_Brief_Order}</title>
            <style type="text/css">
                .dateFormat
                {
                   display:none;
                }

                .doublePanel
                {
                    min-height: 16.5em;
                }

            </style>
        </apex:define>
        <apex:define name="bodyContent">
         <link rel="stylesheet" type="text/css" href="https://rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css" />
         <style type="text/css">
            .select2-container {
                width: 100%;
            }

            a.select2-choice.select2-default {
                height: 34px;
                border-radius: 2px;
            }

         </style>
            <!-- pdf pupop -->
            <div style="display:none;">
                <div id="pdf_brief_dialog" class="mfp-hide popup-content smallPopup">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <span id="popup-title">{!$Label.LV_SO_export_as_pdf}</span>
                            <i class="glyphicon glyphicon-remove pull-right"></i>
                        </div>
                        <div class="panel-body">
                            <!-- <apex:form id="pdf_brief_dialog_form"> -->

                                <div class="dynamicContent row">
                                    <div class="form-group required flex">
                                        <label class="col-sm-5 control-label">{!$Label.LV_SO_Language}</label>

                                        <div class="col-sm-6 btn-group">
                                            <button aria-expanded="false" class="btn btn-default dropdown-toggle " data-toggle="dropdown" id="dropDownSelected" type="button">
                                                <span class="caret" style="margin-left: 6px;"></span>{!$Label.LV_SO_None}
                                            </button>
                                            <ul class="dropdown-menu" role="menu">
                                                <apex:repeat value="{!langCodeList}" var="langcode">
                                                    <li role="presentation">
                                                        <a data-langcode="{!langcode}" class="dropDownOption" role="menuitem" href="javascript:void(0)">{!$Label[languagesMap[langCode]]}</a>
                                                    </li>
                                                </apex:repeat>
                                            </ul>
                                            <label id="selectLanguageError" style="display: none;" class="error">{!$Label.LV_SO_This_field_is_required}</label>
                                        </div>




                                        <!-- <button aria-expanded="true" class="btn btn-default dropdown-toggle " data-toggle="dropdown" type="button"><span class="caret"></span>--None--</button>
                                        <ul aria-required="true">
                                            <apex:repeat value="{!langCodeList}" var="langCode">
                                                <li value="{!langCode}">{!$Label[languagesMap[langCode]]}</li>
                                            </apex:repeat>
                                        </ul> -->
                                    </div>

                                    <div class="row">
                                        <button type="button" id="cancelExportPdf" class="btn btn-warning margin-left">
                                            {!$Label.LV_SO_Cancel}
                                        </button>
                                        <button type="button" id="createPDF" class="btn btn-primary margin-left">
                                            {!$Label.LV_SO_Create}
                                        </button>
                                    </div>  
                                </div>
                                
                            <!-- </apex:form> -->
                        </div>
                    </div>
                </div>
            </div>

            <apex:form styleclass="form-horizontal" id="formToRerender">
                
<!--                 <apex:outputText value="Role by Opportunity {0}" >
                    <apex:param value="{!role}" />
                </apex:outputText> -->

                <apex:outputPanel id="messagesPanelId">
                    <apex:outputPanel rendered="{!showMessageOnTop}">
                        <div class="alert alert-danger" role="alert">
                            <apex:messages />
                        </div>
                    </apex:outputPanel>
                    <section id="messages">
                        <div id="fillFieldsError"/>
                    </section>
                </apex:outputPanel>




                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-sm-7 col-md-6 col-xs-4 panel-title">
                                {!concatenateTitle}<!-- {!Opportunity.Name} -->
                            </div>

                            <div class="col-sm-5  col-md-6 col-xs-8 " style="text-align:right;">
                                <apex:outputPanel id="approvalCheckboxsPanel">
                                    <!-- <apex:outputPanel layout="none" rendered="{!Opportunity.SPO_ProductCategory__c== oppWatch}"> -->
                                    <!-- For all process 
                                         Todo Read for store profile. Edit for other + production  -->
                                    <div>
                                        <div class="pull-right" style="margin-right:12px">
                                            <apex:outputPanel layout="inline" styleClass="padding-right:5px; float:right;" >
                                                <label style="padding-right:5px; padding-bottom:2px;">{!$ObjectType.Opportunity.fields.SPO_ZoneApproval__c.Label}</label>

                                                <!-- write/read -->
                                                <apex:outputPanel rendered="{!AND(baseRole!='Store', !CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                    <apex:inputCheckbox value="{!zoneApproval}" onclick="zoneApprovalClick()"/>
                                                </apex:outputPanel>
                                                <!-- readonly -->
                                                <apex:outputPanel rendered="{!OR(baseRole=='Store', CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                    <apex:inputCheckbox value="{!zoneApproval}" html-c-readonly="readonly" />
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                        </div>
                                    </div>
                                    <!-- </apex:outputPanel> -->
                                       
                                    <!-- For watch only 
                                         Read for store profile. Edit for other + production  -->
                                    <apex:outputPanel layout="none" rendered="{!Opportunity.SPO_ProductCategory__c== oppWatch}">
                                        <div>
                                            <div class="pull-right" style="margin-right:12px">
                                                <apex:outputPanel layout="inline" styleClass="padding-right:5px; float:right;" >
                                                    <label style="padding-right:5px;">{!$ObjectType.Opportunity.fields.SPO_CentralApproval__c.Label}
                                                    </label>
                                                    <!-- <apex:inputCheckbox value="{!theSessionState.displayOrder}" /> -->
                                                    <!-- write/read -->
                                                    <apex:outputPanel rendered="{!AND(baseRole!='Store', !CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                        <apex:inputCheckbox value="{!centralApproval}" onclick="zoneApprovalClick()"/>
                                                    </apex:outputPanel>
                                                    <!-- readonly -->
                                                    <apex:outputPanel rendered="{!OR(baseRole=='Store', CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                        <apex:inputCheckbox value="{!centralApproval}" html-c-readonly="readonly" />
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                            </div>
                                        </div>
                                    </apex:outputPanel>

                                    <!-- In display order process 
                                         Todo : Read for store profile. Edit for other + production  -->
                                    <apex:outputPanel layout="none" rendered="{!displayOrder}">
                                        <div>
                                            <div class="pull-right" style="margin-right:12px">
                                                <apex:outputPanel layout="inline" styleClass="padding-right:5px; float:right;" >
                                                    <label style="padding-right:5px;">{!$ObjectType.Opportunity.fields.SPO_MarketingApproval__c.Label}</label>
                                                    
                                                    <apex:outputPanel rendered="{!AND(baseRole!='Store', !CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                        <apex:inputCheckbox value="{!marketingApproval}" onclick="zoneApprovalClick()"/>
                                                    </apex:outputPanel>
                                                    <!-- readonly -->
                                                    <apex:outputPanel rendered="{!OR(baseRole=='Store', CONTAINS('Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName))}">
                                                        <apex:inputCheckbox value="{!marketingApproval}" html-c-readonly="readonly" />
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                            </div>
                                        </div>
                                    </apex:outputPanel>

                                </apex:outputPanel>
                            </div>

                        </div><!-- row -->

                        <apex:actionFunction action="{!zoneApprovalClick}" name="zoneApprovalClick" oncomplete="console.log('sueccess')" />
                    </div>



                    <div class="panel-body">

                            <!-- 1)  Opportunity status “quotation in progress”  -->
                            <!-- 2) Opportunity Status “quotation submitted” => Confirm or reject quotation  -->
                            <!-- 3) Reject quotation button -->
                            <!-- 4) Accept quotation button + deposit -->
                            <!-- 5) Opportunity status is “deposit sent” Product follow-up -->
                            

                            <!-- popup of 'Cancel' button -->
                            <!-- <div id="open_cancel" class="mfp-hide popup-content">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <span id='popup-title'></span>
                                        <i class="glyphicon glyphicon-remove pull-right"></i>
                                    </div>
                                    <div class="panel-body">
                                        <div class="dynamicContent row"> -->
                                            <!-- put here the 3 fields of cancel comments
                                            <!-- put button of translation -->
                                        <!--so </div>
                                    </div>
                                </div>
                            </div> -->


                            <div class="panel panel-info allFormFields">

                                <!-- <div class="panel-heading">
                                    <h4>{!$Label.LV_SO_Brief_Order}</h4>
                                </div> -->

                                <div class="panel-body">
                                        <apex:inputField style="display: none !important;" value="{! Opportunity.SPO_ProductCategory__c }" rendered="TRUE" />
                                        <apex:inputField style="display: none !important;" value="{! Opportunity.SPO_StrapMaterial__c }" rendered="TRUE" />

                                        <!-- Only to make the page work after Kevin change the data model without contact me... -->
                                        <!-- <apex:inputField id="SPO_MainMaterialSAP_InputFIeld" style="display: none !important;" value="{! Opportunity.SPO_MainMaterialSAP__c }" rendered="TRUE" /> -->
                                        <!--  -->

                                        <!--Information table-->
                                        <article class="panel panel-primary">
                                            <div class="panel-heading">{!$Label.LV_SO_INFORMATION}</div>
                                            <div class="panel-body">
                                                <!-- Left part -->
                                                <section class="col-sm-6">
                                                    <apex:outputPanel rendered="{! Opportunity.SPO_OpportunityCloning__c }">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_OpportunityCloning__c.Label }</label>
                                                            <div class="col-sm-6">
                                                                <div class="checkbox">
                                                                    <label>
                                                                        <apex:inputCheckbox value="{! Opportunity.SPO_OpportunityCloning__c }" html-c-readonly="readonly" />
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <!--<apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Account.fields.Salutation.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.Account.Salutation}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel> -->
                                                    
                                                    <div class="form-group">
                                                        <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ClientCompleteName__c.Label}</label>
                                                        <div class="col-sm-6">
                                                            <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_ClientCompleteName__c }" style="width: 100% !important;" />
                                                        </div>
                                                    </div>
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_BriefCode__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_BriefCode__c}" style="width: 100% !important;"  />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <!-- <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Account.fields.LastName.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.Account.LastName}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel> -->
<!--                                                     <apex:outputPanel rendered="{!(contains('Store',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.Name.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.Name}" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel> -->
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ProductCategory__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_ProductCategory__c}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_OrderType__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_OrderType__c}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.ProductReferential__c.fields.SPO_ProductNameSKU__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_BaseSKURefmodelSKU__r.SPO_ProductNameSKU__c}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <div class="form-group">
                                                        <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_CACode__c.Label }</label>
                                                        <div class="col-sm-6">
                                                            <apex:inputField id="caCodeId" styleClass="form-control" value="{! Opportunity.SPO_CACode__c }" 
                                                            html-i-readonly="{!IF(role == 'Production','readonly', '')}"/>
                                                            <!-- <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_CACode__c }" rendered="{! AND(role == 'Production', CONTAINS('Quotation in progress', Opportunity.StageName)) }" /> -->
                                                            <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_CACode__c }" rendered="{! !AND(role == 'Production', CONTAINS('Quotation in progress', Opportunity.StageName)) }" html-c-readonly="readonly" /> -->
                                                        </div>
                                                    </div>
                                                </section>

                                                <!-- Right part -->
                                                <section class="col-sm-6">
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.CreatedDate.Label}</label>
                                                            <div class="col-sm-6">
                                                                <input class="form-control" readonly="true"  value="{!Opportunity.CreatedDate}" style="width: 100% !important;"  />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <!-- Store -->
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">   
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_StoreCode__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_StoreCode__c}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_Store__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_Store__r.Name}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!(contains('Store;Production',role))}">
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_DeliveryAddress__c.Label}</label>
                                                            <div class="col-sm-6">
                                                                <apex:inputtext styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_DeliveryAddress__c}" style="width: 100% !important;" />
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <div class="form-group">
                                                        <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_DeliveryAddressComment__c.Label }</label>
                                                        <div class="col-sm-6">
                                                            <apex:inputTextarea rows="4" styleClass="form-control" value="{! Opportunity.SPO_DeliveryAddressComment__c }" rendered="{! AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}" style="width: 100% !important;"/>
                                                            <apex:inputTextarea rows="4" styleClass="form-control" value="{! Opportunity.SPO_DeliveryAddressComment__c }" rendered="{! NOT(AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )) }" readonly="true" style="width: 100% !important;"  />
                                                        </div>
                                                    </div>
                                                    
                                                </section>
                                            </div>
                                        </article>

                                        
                                        <!-- Prices & Dates -->
                                        <article>
                                            <div class="row">
                                                <div class="panel panel-default"> 
                                                    <!-- Prices table -->
                                                    <apex:outputPanel id="pricesAndDatePanelId">
                                                        <section class="col-md-6">
                                                           <div class="panel panel-primary">

                                                                <div class="panel-heading">{! $Label.LV_SO_PRICES }</div>
                                                                <div class="panel-body priceBody doublePanel">
                                                                    <div class="form-horizontal">

                                                                        <!-- Section Prices Editable by SPO_CRUD_Section_Prices_Opportunities UnitRetailPriceQuotation + hasQuotation -->

                                                                        <!-- BEGIN RMOU CUT -->


                                                                        <apex:inputHidden id="SPO_UnitRetailPriceId2" value="{!Opportunity.SPO_UnitRetailPrice__c}"/>
                                                                        <apex:inputHidden id="SPO_NumberOfDecimalsStoreId2" value="{!Opportunity.SPO_Number_Of_decimals_Store__c}"/>

                                                                        <!-- END RMOU CUT -->                                                                      


                                                                        <!-- Add BY MAUB -->
                                                                        
                                                                        
                                                                        <div class="form-group" style="margin-left: 8px;">
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_SkuQuantity__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <apex:inputField id="pricesForm_SPO_SkuQuantity__c" styleClass="form-control" value="{!Opportunity.SPO_SkuQuantity__c}" html-data-rule-range="0,99" html-data-rule-number="true" rendered="{!OR(AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role)), AND(CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName), CONTAINS('Production', role)))}"/>

                                                                                <!-- <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_SkuQuantity__c}" html-i-readonly="readonly" rendered="{! !OR(AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role)), AND(CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName), CONTAINS('Production', role)))}" /> -->
                                                                                <apex:outputPanel id="SPOSkuQuantityReadOnlyId" rendered="{! !OR(AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role)), AND(CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName), CONTAINS('Production', role)))}">
                                                                                    <input class="form-control" value="{!Opportunity.SPO_SkuQuantity__c}" readonly="readonly"/>
                                                                                </apex:outputPanel>
                                                                            </div>
                                                                        </div>





                                                                        <apex:outputPanel rendered="{!hasQuotation}">
                                                                            <div class="form-group" style="margin-left: 8px;">
                                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_TotalAmount__c.Label}</label>
                                                                               <!--  <div class="col-sm-7"> -->
                                                                               <!--      <div class="row"> -->
                                                                                        <div class="col-sm-6" style="display:none">
                                                                                            <input id="pricesForm_SPO_TotalAmount__c" type="text" class="form-control" readonly="true" value="{!Opportunity.SPO_TotalAmount__c}" data-oldvalue="{!Opportunity.SPO_TotalAmount__c}"/>
                                                                                        </div>
                                                                                        <div class="col-sm-3" style="display:none">
                                                                                            <input type="text" id="currency" class="form-control" readonly="true" value="{!Opportunity.SPO_StoreCurrency__c}" />
                                                                                        </div>
                                                                                        <div class="col-sm-6">
                                                                                            <input type="text" class="form-control" readonly="true"  id="totalAmountAndCurr" value="{!Opportunity.SPO_TotalAmount__c} {!Opportunity.SPO_StoreCurrency__c}" />
                                                                                        </div>
                                                                          <!--           </div>
                                                                                </div> -->
                                                                            </div> 
                                                                        </apex:outputPanel>

                                                                        <apex:outputPanel rendered="{!!hasQuotation}">
                                                                            <div class="form-group" style="margin-left: 8px;">
                                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_TotalAmount__c.Label}</label>
                                                                               <!--  <div class="col-sm-7"> -->
                                                                               <!--      <div class="row"> -->
                                                                                        <div class="col-sm-6" style="display:none">
                                                                                            <input id="pricesForm_SPO_TotalAmount__c" type="text" class="form-control" readonly="true" value="{!totalAmountToDisplayNoQuotation}" data-oldvalue="{!totalAmountToDisplayNoQuotation}" />
                                                                                        </div>
                                                                                        <div class="col-sm-3" style="display:none">
                                                                                            <input type="text" id="currency" class="form-control" readonly="true" value="{!Opportunity.SPO_StoreCurrency__c}" />
                                                                                        </div>
                                                                                        <div class="col-sm-6">
                                                                                            <input type="text" class="form-control" readonly="true"  id="totalAmountAndCurr" value="{!totalAmountToDisplayNoQuotation} {!Opportunity.SPO_StoreCurrency__c}" />
                                                                                        </div>
                                                                          <!--           </div>
                                                                                </div> -->
                                                                            </div> 
                                                                        </apex:outputPanel>

                                                                        <div class="form-group" style="margin-left: 8px;">
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_Free__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <div class="checkbox">
                                                                                    <label>
                                                                                        <apex:inputCheckbox value="{!Opportunity.SPO_Free__c}" id="freeCheckbox" onclick="freeClick()" disabled="{! !OR(AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role)), AND(CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName), CONTAINS('Production', role)))}"/>
                                                                                    </label>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                  

                                                                    </div><!-- form-horizontal -->
                                                                </div><!-- panel-body -->
                                                            </div> <!-- panel panel-primary -->
                                                        </section><!-- col-md-6 -->

                                                        <!-- Dates table -->
                                                        <section class="col-md-6">
                                                           <div class="panel panel-primary">

                                                                <div class="panel-heading">{! $Label.LV_SO_DATES }</div>
                                                                <div class="panel-body datesBody doublePanel">
                                                                    <div class="form-horizontal">

                                                                        <div class="form-group"  style="margin-right: 30px;">
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_EstimatedLeadTime__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <!-- <apex:outputPanel rendered="{!NOT(hasQuotation)}"> -->
                                                                                    <input type="text" class="form-control" readonly="true" value="{!Opportunity.SPO_EstimatedLeadTime__c}" />
                                                                                <!-- </apex:outputPanel> -->
<!--                                                                                 <apex:outputPanel rendered="{!hasQuotation}">
                                                                                    <input type="text" class="form-control" readonly="true" value="{!Opportunity.SPO_Estimated_date_NOMTO__c}" />
                                                                                </apex:outputPanel> -->
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group" style="margin-right: 30px;">
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_PlannedDeliveryDate__c.Label}</label>
                                                                            <div class="col-sm-6 spanField">
                                                                                <!-- <input class="form-control" readonly="true" value="{!Opportunity.SPO_PlannedDeliveryDate__c}" /> -->
                                                                                <apex:outputText rendered="{!NOT(hasQuotation)}" value="{0, date, MMMM d','  yyyy}">
                                                                                    <apex:param value="{!Opportunity.SPO_pddMTO__c}" /> 
                                                                                </apex:outputText>
                                                                                <apex:outputText rendered="{!hasQuotation}" value="{0, date, MMMM d','  yyyy}">
                                                                                    <apex:param value="{!Opportunity.SPO_pddNOMTO__c}" /> 
                                                                                </apex:outputText>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group" style="margin-right: 30px;"><!-- cast from date to datetime -->
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_WishedDate__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <c:SO_BootstrapDatePicker rendered="{! AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}">
                                                                                    <apex:inputtext value="{!wishedDate}" />
                                                                                </c:SO_BootstrapDatePicker>
                                                                                <apex:inputField value="{!Opportunity.SPO_WishedDate__c}" html-i-readonly="readonly" rendered="{! !AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}" styleClass="form-control"/>
                                                                                <!-- <input type="date" class="form-control"  /> -->
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group" style="margin-right: 30px;"><!-- need change to picklist -->
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_SpecialEvents__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <c:SO_BootstrapDropDownEnhanced rendered="{!AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}" selectFieldUniqueName="SPO_SpecialEvents_InputField">
                                                                                    <apex:inputfield id="SPO_SpecialEvents_InputFieldId" value="{!Opportunity.SPO_SpecialEvents__c}" />
                                                                                </c:SO_BootstrapDropDownEnhanced>
                                                                                <!-- <apex:inputField rendered="{! !AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}" value="{!Opportunity.SPO_SpecialEvents__c}" html-disabled="disabled" styleClass="form-control"/> -->
                                                                                <apex:outputPanel styleClass="spanField">
                                                                                    <apex:outputField rendered="{! !AND(CONTAINS('Brief in progress', Opportunity.StageName), CONTAINS('Store', role) )}" value="{!Opportunity.SPO_SpecialEvents__c}"/>
                                                                                </apex:outputPanel>
                                                                            </div>
                                                                        </div>

                                                                    </div><!-- form-horizontal -->

                                                                </div><!-- panel-body -->
                                                            </div> <!-- panel panel-primary -->
                                                        </section><!-- col-md-6 -->
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                        </article>

                                        <apex:outputPanel id="quotationInProgress" rendered="{!hasQuotation}">
                                            <!-- Quotation table (Quotation in progress) -->
                                            <apex:outputPanel rendered="{! 'Production' != role }">
                                                <apex:outputPanel rendered="{!Opportunity.StageName == 'Quotation in progress'}">
                                                    <article class="panel panel-primary">
                                                        <div class="panel-heading">{! $Label.LV_SO_QUOTATION }</div>
                                                        <div class="panel-body">
                                                            <div class="form-group">
                                                                <div class="col-sm-6">
                                                                    <section class="text-primary" >
                                                                        <span class="glyphicon glyphicon-time"></span>&nbsp; {!Opportunity.StageName}
                                                                    </section>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </article>
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                            <!-- Quotation table (Quotation submitted) -->
                                            <apex:outputPanel rendered="{! ('Production' == role && Opportunity.StageName == 'Quotation in progress') || !CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName)}">
                                                <article class="panel panel-primary">
                                                    <div class="panel-heading">{! $Label.LV_SO_QUOTATION }</div>
                                                    <div class="panel-body">
                                                        <section class="col-sm-6">
                                                            
                                                            <apex:outputPanel id="pnl001" rendered="{! 'Production' != role}" layout="none">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_Estimated_date_NOMTO__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputText value="{!Opportunity.SPO_Estimated_date_NOMTO__c}" styleClass="form-control" html-i-readonly="readonly" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:outputPanel id="pnl002" rendered="{! 'Production' == role}" layout="none">
                                                                <div class="form-group {!IF(OR(CONTAINS('Quotation in progress', Opportunity.StageName), isEditMode == true), 'required', '')}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_EstimatedProductionTimeMonths__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField rendered="{! OR(CONTAINS('Quotation in progress', Opportunity.StageName), isEditMode == true)}" styleClass="form-control" value="{!Opportunity.SPO_EstimatedProductionTimeMonths__c}" html-data-rule-maxlength="2" html-data-rule-required="true"/>
                                                                        <apex:inputText rendered="{! !OR(isEditMode == true, CONTAINS('Quotation in progress', Opportunity.StageName))}" styleClass="form-control" value="{!Opportunity.SPO_EstimatedProductionTimeMonths__c}" html-i-readonly="readonly" />
                                                                    </div>
                                                                </div>

                                                                <div class="form-group {!IF(OR(CONTAINS('Quotation in progress', Opportunity.StageName), isEditMode == true),'required','')}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_EstimatedDistributionTime__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField rendered="{! OR(CONTAINS('Quotation in progress', Opportunity.StageName), isEditMode == true)}" styleClass="form-control" value="{!Opportunity.SPO_EstimatedDistributionTime__c}" html-data-rule-maxlength="2" html-data-rule-required="true"/>
                                                                        <apex:inputText rendered="{! !OR(isEditMode == true, CONTAINS('Quotation in progress', Opportunity.StageName))}" styleClass="form-control" value="{!Opportunity.SPO_EstimatedDistributionTime__c}" html-i-readonly="readonly" />
                                                                    </div>
                                                                </div>
                                                             </apex:outputPanel>  <!-- end panel pnl002 -->

                                                             <!-- BEGIN RMOU EDIT -->


                                                            <div class="form-group required">
                                                                <apex:outputPanel rendered="{! AND(isCRUDSectionPricesOpportunitiesUser , hasQuotation)}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_UnitRetailPriceQuotation__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">
                                                                                    <!--<input class="form-control valid"  type="text" value="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" readonly ="true" aria-invalid="false"/>-->
                                                                                    <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" html-data-rule-required="true" style="width: auto; display: inline;" html-data-oldvalue="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" id="UnitRetailPricesIdInEdit"/>

                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{! AND(isCRUDSectionPricesOpportunitiesUser , !hasQuotation)}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_UnitRetailPrice__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">
                                                                                    
                                                                                    <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_UnitRetailPrice__c}" html-data-rule-required="true" style="width: auto; display: inline;" html-data-oldvalue="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" id="UnitRetailPricesIdInEdit1"/>


                                                                                    <!--<input class="form-control valid" size="20" type="text" value="{!rmsArticlePriceToDisplayNoQuotation} {!Opportunity.SPO_StoreCurrency__c}" aria-invalid="false" data-id='{!Opportunity.SPO_UnitRetailPrice__c}' readonly="true"  id="rmsArticlePriceToDisplayNoQuotationId"/>-->
                                                                                    <apex:inputHidden id="SPO_UnitRetailPriceId" value="{!Opportunity.SPO_UnitRetailPrice__c}"/>
                                                                                    <apex:inputHidden id="SPO_NumberOfDecimalsStoreId" value="{!Opportunity.SPO_Number_Of_decimals_Store__c}"/>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            
                                                            <!-- Section Prices Read Only By ZoneApproval Users + hasQuotation -->
                                                            <div class="form-group">
                                                                <apex:outputPanel rendered="{! AND(isZoneApprovalUser , hasQuotation)}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_UnitRetailPriceQuotation__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">
                                                                
                                                                                    <input class="form-control valid" size="20" type="text" value="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" aria-invalid="false" data-id='{!Opportunity.SPO_UnitRetailPriceQuotation__c}' readonly="true"  id="UnitRetailPriceToDisplayId"/>
                                                                                   
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{! AND(isZoneApprovalUser , !hasQuotation)}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_UnitRetailPrice__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">

                                                                                    <input class="form-control valid" size="20" type="text" value="{!rmsArticlePriceToDisplayNoQuotation}" aria-invalid="false" data-id='{!Opportunity.SPO_UnitRetailPrice__c}' readonly="true"  id="rmsArticlePriceToDisplayNoQuotationId"/>
                                                                                    <apex:inputHidden id="SPO_UnitRetailPriceId1" value="{!Opportunity.SPO_UnitRetailPrice__c}"/>
                                                                                    <apex:inputHidden id="SPO_NumberOfDecimalsStoreId1" value="{!Opportunity.SPO_Number_Of_decimals_Store__c}"/>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            
                                                            <!-- Add BY MAUB -->
                                                            
                                                            <!-- Section Prices Editable by SPO_CRUD_Section_Prices_Opportunities ExportPrice  -->
                                                            <div class="form-group required">
                                                                <apex:outputPanel rendered="{!isCRUDSectionPricesOpportunitiesUser }">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ExportPrice__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">

                                                                                    <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_ExportPrice__c}" html-data-rule-required="true" style="width: auto; display: inline;" html-data-oldvalue="{!Opportunity.SPO_ExportPrice__c}" id="exportPricesIdInEdit"/>
                                                                                    
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </apex:outputPanel> 
                                   
                                                            </div>
                                                            <!-- Section Prices ReadOnly by By ZoneApproval Users ExportPrice  -->
                                                            <div class="form-group">
                                                                <apex:outputPanel rendered="{!isZoneApprovalUser && !isCRUDSectionPricesOpportunitiesUser }">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ExportPrice__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="form-horizontal">

                                                                                    <input class="form-control valid" size="20" type="text" value="{!Opportunity.SPO_ExportPrice__c}" aria-invalid="false" data-id='{!Opportunity.SPO_ExportPrice__c}' readonly="true"  id="rmsArticlePriceToDisplayNoQuotationId"/>
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </apex:outputPanel> 
                                   
                                                            </div>

                                                             <!-- END RMOU EDIT -->


                                                             <!-- BEGIN RMOU CUT -->

                                                            <apex:outputPanel rendered="{! !isZoneApprovalUser && !isCRUDSectionPricesOpportunitiesUser }">
                                                                <div class="form-group {!IF( OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true), 'required', '')}" >
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_UnitRetailPriceQuotation__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <apex:inputText rendered="{! !OR(isEditMode == true, AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'))}" styleClass="form-control" value="{!Opportunity.SPO_UnitRetailPriceCurrencyInclude__c}" html-i-readonly="readonly" html-data-oldvalue="{!Opportunity.SPO_UnitRetailPriceCurrencyInclude__c}" id="unitRetailPriceId"/>

                                                                        <div class="required">
                                                                            <apex:outputPanel rendered="{!OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true)}">

                                                                                <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" html-data-rule-required="true" style="width: auto; display: inline;" html-data-oldvalue="{!Opportunity.SPO_UnitRetailPriceQuotation__c}" id="unitRetailPriceIdInEdit"/>

                                                                                <span class="postfix">{!Opportunity.SPO_StoreCurrency__c}</span>

                                                                            </apex:outputPanel>
                                                                        </div>


                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>

                                                            <apex:outputPanel rendered="{! 'Production' == role && !isZoneApprovalUser && !isCRUDSectionPricesOpportunitiesUser }">
                                                                <div class="form-group {!IF( OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true), 'required', '')}" >
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ExportPrice__c.Label}</label>
                                                                    <div class="col-sm-6">

                                                                        <apex:inputText rendered="{! !OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), OR(role == 'Production', role == 'Other') ), isEditMode == true)}" styleClass="form-control" value="{!Opportunity.SPO_ExportPriceCurrencyInclude__c}" html-i-readonly="readonly" html-data-oldvalue="{!Opportunity.SPO_ExportPriceCurrencyInclude__c}" id="exportPriceId"/>


                                                                        <apex:outputPanel rendered="{! OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), OR(role == 'Production', role == 'Other') ), isEditMode == true)}">
                                                                            <div class="row">
                                                                                <div class="col-sm-6">
                                                                                    <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_ExportPrice__c}" html-data-rule-required="true" style="width: auto; display: inline;" html-data-oldvalue="{!Opportunity.SPO_ExportPrice__c}" id="exportPriceIdInEdit"/>
                                                                                </div>
                                                                                <div class="col-sm-6">
                                                                                    <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_CurrencyExportPrice_InputField" >
                                                                                       <apex:inputField id="SPO_CurrencyExportPrice_InputFieldId" value="{! Opportunity.SPO_CurrencyExportPrice__c }" />
                                                                                    </c:SO_BootstrapDropDownEnhanced>
                                                                                </div>
                                                                            </div>
                                                                        </apex:outputPanel>

                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>  

                                                            <!-- END RMOU CUT -->

                                                            <apex:outputPanel rendered="{! 'Production' == role }">
                                                                <div class="form-group {!IF( OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true), 'required', '')}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_Numberofproductivehours__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField rendered="{! !OR(isEditMode == true, AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'))}" styleClass="form-control" value="{!Opportunity.SPO_Numberofproductivehours__c}" html-i-readonly="readonly" />
                                                                        <apex:inputField rendered="{! OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true)}" styleClass="form-control" value="{!Opportunity.SPO_Numberofproductivehours__c}" html-data-rule-required="true" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                        <section class="col-sm-6">
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_ProductionQuoteComment__c.Label}</label>
                                                                <div class="col-sm-6">
                                                                    <apex:inputTextarea rendered="{! !OR(isEditMode == true, AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'))}" rows="6" styleClass="form-control" value="{!Opportunity.SPO_ProductionQuoteComment__c}" readonly="true" style="width: 100% !important;"/>
                                                                    <apex:inputTextarea rendered="{! OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true)}" rows="6" styleClass="form-control" value="{!Opportunity.SPO_ProductionQuoteComment__c}" />
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel id="QoutationSection_CRS_FieldId" rendered="{! 'Production' == role }">
                                                                <div class="form-group {!IF( OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true), 'required', '')}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_CRS__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <div class="form-horizontal">

                                                                            <apex:inputText value="{!Opportunity.SPO_CRSCurrencyInclude__c}" rendered="{! !OR(isEditMode == true, AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'))}" styleClass="form-control" html-i-readonly="readonly" />

                                                                            <apex:outputPanel rendered="{! OR(AND(CONTAINS('Quotation in progress', Opportunity.StageName), role == 'Production'), isEditMode == true)}">
                                                                                <apex:inputField styleClass="form-control" value="{!Opportunity.SPO_CRS__c}" html-data-rule-required="true" style="width: auto; display: inline;"/>
                                                                                <span class="postfix">€</span>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                    </div>
                                                </article>
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <!-- Deposit table (Quotation accepted)  (after click on 'Accept quotation' button) -->
                                        <apex:outputPanel id="quotationAccepted">
                                            <apex:outputPanel rendered="{! AND(!displayOrder, OR(AND(!hasQuotation, role != 'Production'), AND(hasQuotation, !CONTAINS('Quotation submitted;Quotation in progress;Brief in progress', Opportunity.StageName))))}">
                                                <article class="panel panel-primary">
                                                    <div class="panel-heading">{! $Label.LV_SO_DEPOSIT }</div>
                                                    <div class="panel-body depositBody">

                                                        <!-- <section class="row"> -->
                                                            <div class="col-sm-6">
                                                            <apex:outputPanel id="depositAmountRerender">

                                                                    <div class="form-group">
                                                                        <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_DepositAmount__c.Label}</label>
                                                                        <div class="col-sm-6">
                                                                             <div class="form-horizontal">

                                                                                <apex:outputPanel rendered="{!
                                                                                AND(
                                                                                    role=='Store', 
                                                                                    OR(
                                                                                        Opportunity.StageName == 'Quotation accepted', 
                                                                                        AND(
                                                                                            Opportunity.StageName == 'Brief in progress', !hasQuotation
                                                                                            )
                                                                                        )
                                                                                    )}">
                                                                                    <apex:inputText styleclass="form-control" id="SPO_DepositAmount_InputFieldId" value="{!Opportunity.SPO_DepositAmount__c}" onkeyup="requiredComment()" style="width: auto; display: inline;"/>

                                                                                    <span class="postfix">{!Opportunity.SPO_StoreCurrency__c}</span>

                                                                                </apex:outputPanel>

                                                                                <apex:outputPanel rendered="{! !AND(role=='Store', OR(Opportunity.StageName == 'Quotation accepted', AND(Opportunity.StageName == 'Brief in progress', !hasQuotation)))}">
                                                                                    <input id="SPO_DepositAmount_InputFieldId" type="text" class="form-control" readonly="true"  value="{!Opportunity.SPO_DepositAmountCurrencyInclude__c}" />
                                                                                </apex:outputPanel>


                                                                            
                                                                                
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                            </apex:outputPanel>
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_DueAmount__c.Label}</label>
                                                                    <div class="col-sm-6">   
                                                                        <div class="form-horizontal">
                                                                            <input id="Opportunity__SPO_DueAmount__c" type="text" class="form-control" readonly="true" value="{!Opportunity.SPO_DueAmount__c} {!Opportunity.SPO_StoreCurrency__c}" />
                                                                            <!-- <span class="postfix">{!Opportunity.SPO_StoreCurrency__c}</span> -->
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                            <div class="col-sm-6">
                                                            <apex:outputPanel id="depositAmount">
                                                            
                                                                        <div class="form-group {!IF(AND(role=='Store', OR(Opportunity.StageName == 'Quotation accepted', AND(Opportunity.StageName == 'Brief in progress', !hasQuotation))), 'required', '')}" id="depositComment">
                                                                            <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_DepositComment__c.Label}</label>
                                                                            <div class="col-sm-6">
                                                                                <apex:inputField styleClass="form-control" html-data-rule-required="true" value="{!Opportunity.SPO_DepositComment__c}" rendered="{!AND(role=='Store', OR(Opportunity.StageName == 'Quotation accepted', AND(Opportunity.StageName == 'Brief in progress', !hasQuotation)))}" id="comentField"/>
                                                                                <apex:outputPanel rendered="{! !AND(role=='Store', OR(Opportunity.StageName == 'Quotation accepted', AND(Opportunity.StageName == 'Brief in progress', !hasQuotation)))}">
                                                                                    <input type="text" class="form-control" readonly="true"  value="{!Opportunity.SPO_DepositComment__c}" id="comentFieldReadOnly"/>
                                                                                </apex:outputPanel>
                                                                            </div>
                                                                        </div>
                                                                
                                                            </apex:outputPanel>
                                                        </div>

                                                    </div>
                                                </article>
                                            </apex:outputPanel>
                                        </apex:outputPanel>


                                        <!-- Start -->
                                        <apex:outputPanel rendered="{! AND('Production' == role, CONTAINS('Deposit sent;Creation in progress;In progress;Payment confirmed;Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName)) }" id="referentialSectionId">
                                            <article class="panel panel-primary">
                                                <div class="panel-heading">{! $Label.LV_SO_REFERENTIAL }</div>
                                                <div class="panel-body" id="referentialSectionBody">
                                                
                                                    <!-- LG -->
                                                    <apex:outputPanel rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                        <section class="col-sm-6">
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Description__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_Description__c }" html-data-rule-required="true"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="form-group required">
                                                                <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MarketingColor__c.Label }</label>
                                                                <div class="col-sm-6">
                                                                    <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MarketingColor_InputField">
                                                                        <apex:inputField id="SPO_MarketingColor_InputFieldId" value="{! Opportunity.SPO_MarketingColor__c }" />
                                                                    </c:SO_BootstrapDropDownEnhanced>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SizeHeight__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_SizeHeight__c }" rendered="TRUE" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SizeLenght__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_SizeLenght__c }" rendered="TRUE" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Sizewidth__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_Sizewidth__c }" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>

                                                            <!-- Ticket 763 - need to remove SPO_ExteriorMaterial1__c field and replace it with SPO_MainMaterialSAP__c -->
                                                            <div class="form-group required">
                                                                <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MainMaterialSAP__c.Label }</label>
                                                                <div class="col-sm-6">
                                                                    <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MainMaterialSAP_InputField">
                                                                        <apex:inputField id="SPO_MainMaterialSAP_InputFieldId" value="{! Opportunity.SPO_MainMaterialSAP__c }" />
                                                                    </c:SO_BootstrapDropDownEnhanced>
                                                                    <apex:actionFunction name="SPO_MainMaterialSAP_InputFieldreRenderfunction" reRender="SPO_MacroMaterial_PannelId" oncomplete="rerender_SPO_MainMaterialSAP_dependands();" />
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel id="SPO_MacroMaterial_PannelId">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MacroMaterial__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MacroMaterial_InputField">
                                                                            <apex:inputText id="SPO_MacroMaterial_InputFieldId" value="{! Opportunity.SPO_MacroMaterial__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>

                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Gender__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Gender_InputField">
                                                                            <apex:inputfield id="SPO_Gender_InputFieldId" value="{! Opportunity.SPO_Gender__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_ManuFacturerProcess__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_ManuFacturerProcess_InputField">
                                                                            <apex:inputField id="SPO_ManuFacturerProcess_InputFieldId" value="{! Opportunity.SPO_ManuFacturerProcess__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubAestheticline_PannelId_LG" >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubAestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubAestheticline_InputField">
                                                                            <apex:inputField id="SPO_SubAestheticline_InputFieldId" value="{! Opportunity.SPO_SubAestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubAestheticline_InputFieldreRenderfunction" reRender="SPO_Aestheticline_PanelId_LG" oncomplete="rerender_SPO_SubAestheticline_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Aestheticline_PanelId_LG" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Aestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Aestheticline_InputField">
                                                                            <apex:inputField id="SPO_Aestheticline_InputFieldId" value="{! Opportunity.SPO_Aestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_Aestheticline__c }" rendered="{! 'Watch' != Opportunity.SPO_ProductCategory__c }" html-i-readonly="readonly" /> -->
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MadeIn__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MadeIn_InputField">
                                                                            <apex:inputField id="SPO_MadeIn_InputFieldId" value="{! Opportunity.SPO_MadeIn__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                        <section class="col-sm-6">
                                                            <apex:outputPanel id="SPO_SubGroup_PanelId_LG" >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubGroup__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubGroup_InputField">
                                                                            <apex:inputField id="SPO_SubGroup_InputFieldId" value="{! Opportunity.SPO_SubGroup__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubGroup_InputFieldreRenderfunction" reRender="SPO_GroupAccWatch_PanelId_LG, SPO_GroupLG_PanelId, SPO_ItemDimensionGroupWatch_PanelId, SPO_SubFamilyLG_PanelId, SPO_ItemDimensionGroupAcc_PanelId, SPO_MainGroupAccWa_PanelId, SPO_FamilyLG_PanelId, SPO_Item_DimensionGroupLG_PanelId, SPO_MainGroupLG_PanelId, SPO_MacroFamilyLG_PanelId" oncomplete="rerender_SPO_SubGroup_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_GroupLG_PanelId" rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_GroupLG__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_GroupLG_InputField">
                                                                            <apex:inputField id="SPO_GroupLG_InputFieldId" value="{! Opportunity.SPO_GroupLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_GroupLG_InputFieldreRenderfunction" reRender="SPO_FamilyLG_PanelId, SPO_MainGroupLG_PanelId" oncomplete="rerender_SPO_GroupLG_dependands();"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_MainGroupLG_PanelId" rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MainGroupLG__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MainGroupLG_InputField">
                                                                            <apex:inputField id="SPO_MainGroupLG_InputFieldId" value="{! Opportunity.SPO_MainGroupLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_MainGroupLG_InputFieldreRenderfunction" reRender="SPO_MacroFamilyLG_PanelId" oncomplete="rerender_SPO_MainGroupLG_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubFamilyLG_PanelId" rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubFamilyLG__c.Label }</label>
                                                                    <div class="col-sm-6">
        
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubFamilyLG_InputField">
                                                                            <apex:inputField id="SPO_SubFamilyLG_InputFieldId" value="{! Opportunity.SPO_SubFamilyLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_FamilyLG_PanelId" rendered="{!oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_FamilyLG__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_FamilyLG_InputField" rendered="TRUE">
                                                                            <apex:inputField id="SPO_FamilyLG_InputFieldId" value="{! Opportunity.SPO_FamilyLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_MacroFamilyLG_PanelId" rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MacroFamilyLG__c.Label }</label>
                                                                    <div class="col-sm-6">

                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MacroFamilyLG_InputField">
                                                                            <apex:inputField id="SPO_MacroFamilyLG_InputFieldId" value="{! Opportunity.SPO_MacroFamilyLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Item_DimensionGroupLG_PanelId" rendered="{! oppLeatherGood == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Item_DimensionGroupLG__c.Label }</label>
                                                                    <div class="col-sm-6">
           
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Item_DimensionGroupLG_InputField">
                                                                            <apex:inputField id="SPO_Item_DimensionGroupLG_InputFieldId" value="{! Opportunity.SPO_Item_DimensionGroupLG__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubDepartment_PanelId_LG" style="{!IF( oppWatch == Opportunity.SPO_ProductCategory__c, '', 'display:none;' )}">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubDepartment__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubDepartment_InputField">
                                                                            <apex:inputField id="SPO_SubDepartment_InputFieldId" value="{! Opportunity.SPO_SubDepartment__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubDepartment_InputFieldreRenderfunction" reRender="SPO_Department_PanelId_LG" oncomplete="rerender_SPO_SubDepartment_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Department_PanelId_LG" rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Department__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Department_InputField" rendered="TRUE" readonly="true">
                                                                            <apex:inputField id="SPO_Department_InputFieldId" value="{! Opportunity.SPO_Department__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_Department_InputFieldreRenderfunction" reRender="" oncomplete="rerender_SPO_Department_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Activity2_PanelId_LG" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Activity2__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Activity2_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_Activity2_InputFieldId" value="{! Opportunity.SPO_Activity2__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SalesType__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SalesType_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_SalesType_InputFieldId" value="{! Opportunity.SPO_SalesType__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_TypeComposition1__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_TypeComposition1__c }" html-data-rule-required="true"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                    </apex:outputPanel>

                                                    <!-- Watch -->
                                                    <apex:outputPanel rendered="{! oppWatch == Opportunity.SPO_ProductCategory__c }">
                                                        <section class="col-sm-6">
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Description__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_Description__c }" html-data-rule-required="true"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="form-group required">
                                                                <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_StrapMaterialSAP__c.Label }</label>
                                                                <div class="col-sm-6">
                                                                    <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_StrapMaterialSAP_InputField">
                                                                        <apex:inputField id="SPO_StrapMaterialSAP_InputFieldId" value="{! Opportunity.SPO_StrapMaterialSAP__c }" />
                                                                    </c:SO_BootstrapDropDownEnhanced>
                                                                    <apex:actionFunction name="SPO_StrapMaterialSAP_InputFieldreRenderfunction" reRender="SPO_StrapMainMaterial_PanelId" oncomplete="rerender_SPO_StrapMaterialSAP_dependands();" />
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel id="SPO_StrapMainMaterial_PanelId" rendered="{! oppWatch == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_StrapMainMaterial__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_StrapMainMaterial_InputField">
                                                                            <apex:inputField id="SPO_StrapMainMaterial_InputFieldId" value="{! Opportunity.SPO_StrapMainMaterial__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_StrapColor_PanelId" rendered="{! oppWatch == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_StrapColor__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_StrapColor_InputField">
                                                                            <apex:inputField id="SPO_StrapColor_InputFieldId" value="{! Opportunity.SPO_StrapColor__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! oppWatch == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_WristSize__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <!-- <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_WristSize_InputField"> -->
                                                                            <apex:inputField styleClass="form-control" id="SPO_WristSize_InputFieldId" value="{! Opportunity.SPO_WristSize__c }" />
                                                                        <!-- </c:SO_BootstrapDropDownEnhanced> -->
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubFamilyWatchAcc_PanelId_Watch" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubFamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubFamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_SubFamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_SubFamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubFamilyWatchAcc_InputFieldreRenderfunction" reRender="SPO_FamilyWatchAcc_PanelId_Watch, SPO_MacroFamilyWatchAcc_PanelId_Watch" oncomplete="rerender_SPO_SubFamilyWatchAcc_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_FamilyWatchAcc_PanelId_Watch" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_FamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6">
   
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_FamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_FamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_FamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_FamilyWatchAcc_InputFieldreRenderfunction" reRender="SPO_MacroFamilyWatchAcc_PanelId_Watch" oncomplete="rerender_SPO_FamilyWatchAcc_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_MacroFamilyWatchAcc_PanelId_Watch" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MacroFamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6">
      
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MacroFamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_MacroFamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_MacroFamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubGroup_PanelId_Watch" >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubGroup__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubGroup_InputField">
                                                                            <apex:inputField id="SPO_SubGroup_InputFieldId" value="{! Opportunity.SPO_SubGroup__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubGroup_InputFieldreRenderfunction" reRender="SPO_GroupAccWatch_PanelId_Watch, SPO_GroupLG_PanelId, SPO_ItemDimensionGroupWatch_PanelId, SPO_SubFamilyLG_PanelId, SPO_ItemDimensionGroupAcc_PanelId, SPO_MainGroupAccWa_PanelId, SPO_FamilyLG_PanelId, SPO_Item_DimensionGroupLG_PanelId, SPO_MainGroupLG_PanelId, SPO_MacroFamilyLG_PanelId" oncomplete="rerender_SPO_SubGroup_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_GroupAccWatch_PanelId_Watch" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_GroupAccWatch__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_GroupAccWatch_InputField">
                                                                            <apex:inputField id="SPO_GroupAccWatch_InputFieldId" value="{! Opportunity.SPO_GroupAccWatch__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_GroupAccWatch_InputFieldreRenderfunction" 
                                                                        reRender="SPO_MainGroupAccWa_PanelId" oncomplete="rerender_SPO_GroupAccWatch_dependands();"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_MainGroupAccWa_PanelId" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MainGroupAccWa__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MainGroupAccWa_InputField">
                                                                            <apex:inputField id="SPO_MainGroupAccWa_InputFieldId" value="{! Opportunity.SPO_MainGroupAccWa__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_ItemDimensionGroupWatch_PanelId" rendered="{! oppWatch == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_ItemDimensionGroupWatch__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_ItemDimensionGroupWatch_InputField">
                                                                            <apex:inputField id="SPO_ItemDimensionGroupWatch_InputFieldId" value="{! Opportunity.SPO_ItemDimensionGroupWatch__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                        <section class="col-sm-6">
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MadeIn__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MadeIn_InputField">
                                                                            <apex:inputField id="SPO_MadeIn_InputFieldId" value="{! Opportunity.SPO_MadeIn__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubDepartment_PanelId_Watch" style="{!IF( oppWatch == Opportunity.SPO_ProductCategory__c, '', 'display:none;' )}">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubDepartment__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubDepartment_InputField">
                                                                            <apex:inputField id="SPO_SubDepartment_InputFieldId" value="{! Opportunity.SPO_SubDepartment__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubDepartment_InputFieldreRenderfunction" reRender="SPO_Department_PanelId_Watch" oncomplete="rerender_SPO_SubDepartment_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Department_PanelId_Watch" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Department__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Department_InputField" rendered="TRUE" readonly="true">
                                                                            <apex:inputField id="SPO_Department_InputFieldId" value="{! Opportunity.SPO_Department__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_Department_InputFieldreRenderfunction" reRender="" oncomplete="rerender_SPO_Department_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Activity2_PanelId_Watch" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Activity2__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Activity2_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_Activity2_InputFieldId" value="{! Opportunity.SPO_Activity2__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_SubAestheticline_PannelId_Watch" >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubAestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubAestheticline_InputField">
                                                                            <apex:inputField id="SPO_SubAestheticline_InputFieldId" value="{! Opportunity.SPO_SubAestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubAestheticline_InputFieldreRenderfunction" reRender="SPO_Aestheticline_PanelId_Watch" oncomplete="rerender_SPO_SubAestheticline_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel id="SPO_Aestheticline_PanelId_Watch" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Aestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Aestheticline_InputField">
                                                                            <apex:inputField id="SPO_Aestheticline_InputFieldId" value="{! Opportunity.SPO_Aestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_Aestheticline__c }" rendered="{! 'Watch' != Opportunity.SPO_ProductCategory__c }" html-i-readonly="readonly" /> -->
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SalesType__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SalesType_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_SalesType_InputFieldId" value="{! Opportunity.SPO_SalesType__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_TypeComposition1__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_TypeComposition1__c }" html-data-rule-required="true"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Gender__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Gender_InputField">
                                                                            <apex:inputfield id="SPO_Gender_InputFieldId" value="{! Opportunity.SPO_Gender__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_ManuFacturerProcess__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_ManuFacturerProcess_InputField">
                                                                            <apex:inputField id="SPO_ManuFacturerProcess_InputFieldId" value="{! Opportunity.SPO_ManuFacturerProcess__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </section>
                                                    </apex:outputPanel>

                                                    <!-- Accessories -->
                                                    <apex:outputPanel rendered="{! oppAccessory == Opportunity.SPO_ProductCategory__c }">
                                                        <section class="col-sm-6">
                                                            <apex:outputPanel >
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Description__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_Description__c }" html-data-rule-required="true"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <!--item 79 evol 1701 apex:outputPanel rendered="{! oppAccessory == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MarketingColor__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MarketingColor_InputField">
                                                                            <apex:inputField id="SPO_MarketingColor_InputFieldId" value="{! Opportunity.SPO_MarketingColor__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Gender__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Gender_InputField">
                                                                            <apex:inputfield id="SPO_Gender_InputFieldId" value="{! Opportunity.SPO_Gender__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 div class="form-group">
                                                                <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MainMaterialSAP__c.Label }</label>
                                                                <div class="col-sm-6">
                                                                    <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MainMaterialSAP_InputField">
                                                                        <apex:inputField id="SPO_MainMaterialSAP_InputFieldId" value="{! Opportunity.SPO_MainMaterialSAP__c }" />
                                                                    </c:SO_BootstrapDropDownEnhanced>
                                                                    <apex:actionFunction name="SPO_MainMaterialSAP_InputFieldreRenderfunction" reRender="SPO_MacroMaterial_PannelId" oncomplete="rerender_SPO_MainMaterialSAP_dependands();" />
                                                                </div>
                                                            </div-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_SubFamilyWatchAcc_PanelId_Acc" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubFamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubFamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_SubFamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_SubFamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubFamilyWatchAcc_InputFieldreRenderfunction" reRender="SPO_FamilyWatchAcc_PanelId_Acc, SPO_MacroFamilyWatchAcc_PanelId_Acc" oncomplete="rerender_SPO_SubFamilyWatchAcc_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_FamilyWatchAcc_PanelId_Acc" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_FamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6"-->
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_FamilyWatchAcc__c }" rendered="TRUE" html-i-readonly="readonly" /> -->

                                                                        <!--item 79 evol 1701 c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_FamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_FamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_FamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_FamilyWatchAcc_InputFieldreRenderfunction" reRender="SPO_MacroFamilyWatchAcc_PanelId_Acc" oncomplete="rerender_SPO_FamilyWatchAcc_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_MacroFamilyWatchAcc_PanelId_Acc" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MacroFamilyWatchAcc__c.Label }</label>
                                                                    <div class="col-sm-6"-->
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_MacroFamilyWatchAcc__c }" html-readonly="readonly" /> -->

                                                                        <!--item 79 evol 1701 c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MacroFamilyWatchAcc_InputField">
                                                                            <apex:inputField id="SPO_MacroFamilyWatchAcc_InputFieldId" value="{! Opportunity.SPO_MacroFamilyWatchAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_SubGroup_PanelId_Acc" >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubGroup__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubGroup_InputField">
                                                                            <apex:inputField id="SPO_SubGroup_InputFieldId" value="{! Opportunity.SPO_SubGroup__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubGroup_InputFieldreRenderfunction" reRender="SPO_GroupAccWatch_PanelId_Acc, SPO_GroupLG_PanelId, SPO_ItemDimensionGroupWatch_PanelId, SPO_SubFamilyLG_PanelId, SPO_ItemDimensionGroupAcc_PanelId, SPO_MainGroupAccWa_PanelId_Acc, SPO_FamilyLG_PanelId, SPO_Item_DimensionGroupLG_PanelId, SPO_MainGroupLG_PanelId, SPO_MacroFamilyLG_PanelId" oncomplete="rerender_SPO_SubGroup_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_GroupAccWatch_PanelId_Acc" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_GroupAccWatch__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_GroupAccWatch_InputField">
                                                                            <apex:inputField id="SPO_GroupAccWatch_InputFieldId" value="{! Opportunity.SPO_GroupAccWatch__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_GroupAccWatch_InputFieldreRenderfunction" 
                                                                        reRender="SPO_MainGroupAccWa_PanelId_Acc" oncomplete="rerender_SPO_GroupAccWatch_dependands();"/>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_MainGroupAccWa_PanelId_Acc" rendered="{! oppLeatherGood != Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MainGroupAccWa__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MainGroupAccWa_InputField">
                                                                            <apex:inputField id="SPO_MainGroupAccWa_InputFieldId" value="{! Opportunity.SPO_MainGroupAccWa__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_ItemDimensionGroupAcc_PanelId" rendered="{! oppAccessory == Opportunity.SPO_ProductCategory__c }">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_ItemDimensionGroupAcc__c.Label }</label>
                                                                    <div class="col-sm-6"-->
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_ItemDimensionGroupAcc__c }" html-i-readonly="readonly" /> -->

                                                                        <!--item 79 evol 1701 c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_ItemDimensionGroupAcc_InputField">
                                                                            <apex:inputField id="SPO_ItemDimensionGroupAcc_InputFieldId" value="{! Opportunity.SPO_ItemDimensionGroupAcc__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                        <!--item 79 evol 1701 /section>
                                                        <section class="col-sm-6"-->
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_ManuFacturerProcess__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_ManuFacturerProcess_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_ManuFacturerProcess_InputFieldId" value="{! Opportunity.SPO_ManuFacturerProcess__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="TRUE">
                                                                <div class="form-group required">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_MadeIn__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_MadeIn_InputField">
                                                                            <apex:inputField id="SPO_MadeIn_InputFieldId" value="{! Opportunity.SPO_MadeIn__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                           <apex:outputPanel id="SPO_SubDepartment_PanelId_Acc" style="{!IF( oppWatch == Opportunity.SPO_ProductCategory__c, '', 'display:none;' )}">
                                                                <div class="form-group" rendered="false">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubDepartment__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubDepartment_InputField">
                                                                            <apex:inputField id="SPO_SubDepartment_InputFieldId" value="{! Opportunity.SPO_SubDepartment__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubDepartment_InputFieldreRenderfunction" reRender="SPO_Department_PanelId_Acc" oncomplete="rerender_SPO_SubDepartment_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_Department_PanelId_Acc" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Department__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Department_InputField" rendered="TRUE" readonly="true">
                                                                            <apex:inputField id="SPO_Department_InputFieldId" value="{! Opportunity.SPO_Department__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_Department_InputFieldreRenderfunction" reRender="" oncomplete="rerender_SPO_Department_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_Activity2_PanelId_Acc" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Activity2__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Activity2_InputField" readonly="true"-->
                                                                            <!-- <apex:inputField id="SPO_Activity2_InputFieldId" value="{! Opportunity.SPO_Activity2__c }" /> -->
                                                                            <!--item 79 evol 1701 apex:inputField id="SPO_Activity2_InputFieldId" value="{! Opportunity.SPO_Activity2__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_SubAestheticline_PannelId_Acc" >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SubAestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SubAestheticline_InputField">
                                                                            <apex:inputField id="SPO_SubAestheticline_InputFieldId" value="{! Opportunity.SPO_SubAestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                        <apex:actionFunction name="SPO_SubAestheticline_InputFieldreRenderfunction" reRender="SPO_Aestheticline_PanelId_Acc" oncomplete="rerender_SPO_SubAestheticline_dependands();" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <!--item 79 evol 1701 apex:outputPanel id="SPO_Aestheticline_PanelId_Acc" rendered="TRUE">
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_Aestheticline__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_Aestheticline_InputField">
                                                                            <apex:inputField id="SPO_Aestheticline_InputFieldId" value="{! Opportunity.SPO_Aestheticline__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced-->
                                                                        <!-- <apex:inputText styleClass="form-control" value="{! Opportunity.SPO_Aestheticline__c }" rendered="{! 'Watch' != Opportunity.SPO_ProductCategory__c }" html-i-readonly="readonly" /> -->
                                                                    <!--item 79 evol 1701 /div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                            <apex:outputPanel >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_SalesType__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <c:SO_BootstrapDropDownEnhanced selectFieldUniqueName="SPO_SalesType_InputField" readonly="true">
                                                                            <apex:inputField id="SPO_SalesType_InputFieldId" value="{! Opportunity.SPO_SalesType__c }" />
                                                                        </c:SO_BootstrapDropDownEnhanced>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <!--item 79 evol 1701 apex:outputPanel >
                                                                <div class="form-group">
                                                                    <label class="col-sm-4 control-label">{! $ObjectType.Opportunity.fields.SPO_TypeComposition1__c.Label }</label>
                                                                    <div class="col-sm-6">
                                                                        <apex:inputField styleClass="form-control" value="{! Opportunity.SPO_TypeComposition1__c }" />
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel-->
                                                        </section>
                                                    </apex:outputPanel>
                                                </div>
                                            </article>
                                        </apex:outputPanel>


                                        <!-- end -->
                                        <apex:outputPanel id="ManufacturingSectionPanelId">
                                            <apex:outputPanel rendered="{! AND('Production' == role, CONTAINS('Deposit sent;Creation in progress;In progress;Payment confirmed;Closed Won;Cancelled by store;Cancelled by Production', Opportunity.StageName)) }">
                                                <article class="panel panel-primary">
                                                    <div class="panel-heading">{! $Label.LV_SO_MANUFACTURING }</div>
                                                    <div class="panel-body">
                                                    
                                                        <section class="col-sm-6">
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_SkuQuantity__c.Label}</label>
                                                                <div class="col-sm-6">
                                                                    <apex:inputText id="manufacturingSKUQuantityId" styleClass="form-control" value="{!Opportunity.SPO_SkuQuantity__c}" html-readonly="readonly"/>
                                                                </div>
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_OF__c.Label}</label>
                                                                <div class="col-sm-6">
                                                                    <apex:inputTextArea id="SPO_Manufacturing_OF_InputFieldId" rows="4" styleClass="form-control" value="{!Opportunity.SPO_OF__c}"/>
                                                                </div>
                                                            </div>
                                                            <div class="form-group {! IF(AND(clickedOnCreateOrderInERP == false, OR('Creation in progress' == Opportunity.StageName, 'Deposit sent' == Opportunity.StageName)), 'required', '')}" style="margin-bottom: 15px;">
                                                                <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_SpecialOrderSKUCode__c.Label}</label>
                                                                <div class="col-sm-6"> 

                                                                    <apex:outputPanel id="SPO_Manufacturing_SpecialOrderSKUCodeRef_InputFieldId" layout="inline" rendered="{! OR(AND(clickedOnCreateOrderInERP == false, 'Creation in progress' == Opportunity.StageName), AND(CONTAINS('Deposit sent', Opportunity.StageName), CONTAINS('Production', role) ))}">
                                                                            <c:SO_PR_CustomLookup cancelHideUponPressingX="true" isCustomRequired="true" allowclear="true" importjquery="true" labelfield="Name" sobject="ProductReferential__c" valuefield="Id" targetfield="{!Opportunity.SPO_SpecialOrderSKUCodeRef__c}" productCategory="" />
                                                                    </apex:outputPanel>

                                                                    <apex:outputPanel layout="none" rendered="{! !OR(AND(clickedOnCreateOrderInERP == false, 'Creation in progress' == Opportunity.StageName), AND(CONTAINS('Deposit sent', Opportunity.StageName), CONTAINS('Production', role) ))}">
                                                                        <apex:inputText styleclass="form-control" html-readonly="readonly" value="{!Opportunity.SPO_SpecialOrderSKUCode__c}" rendered="{! !OR(AND(clickedOnCreateOrderInERP == false, 'Creation in progress' == Opportunity.StageName), AND(CONTAINS('Deposit sent', Opportunity.StageName), CONTAINS('Production', role) ))}"/>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>

                                                            <div class="form-group required">
                                                                <apex:outputPanel rendered="{! OR(AND(clickedOnCreateOrderInERP == false, 'Creation in progress' == Opportunity.StageName),AND(CONTAINS('Deposit sent', Opportunity.StageName), CONTAINS('Production', role)))}">
                                                                    <label class="col-sm-4 control-label">{!$ObjectType.Opportunity.fields.SPO_CRS__c.Label}</label>
                                                                    <div class="col-sm-6">
                                                                        <div class="form-horizontal">
                                                                            <apex:inputField id="SPO_Manufacturing_CRS_InputFieldId" styleClass="form-control" value="{!Opportunity.SPO_CRS__c}" html-data-rule-manufacturingRequired="true" style="width: auto; display: inline;"/>
                                                                            <span class="postfix">€</span>
                                                                        </div>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            
                                                        </section>

                                                    </div>
                                                </article>
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <!-- Follow Up table -->
                                        <apex:outputPanel id="followUp">
                                            <apex:outputPanel rendered="{!isShowFirmOrderSection}">
                                                <article class="panel panel-primary">
                                                    <div class="panel-heading">{! $Label.LV_SO_FOLLOW_UP }</div>
                                                    <div class="panel-body">
                                                        <div class="table-responsive">
                                                            <table class="table table-hover table-striped" style="border-collapse:collapse;">
                                                                <thead>
                                                                    <tr>
                                                                        <th></th>
                                                                        <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_FirmOrderNumber__c.Label}</th>
                                                                        <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_RevisedDeliveryDate__c.Label}</th>
                                                                        <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_FirmOrderStatus__c.Label}</th>
                                                                        <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_Substatus__c.Label}</th>
                                                                        <th>{! $Label.LV_SO_Action }</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    
                                                                    <apex:repeat value="{!firmOrderWrapperList}" var="orderDetails">

                                                                        <apex:variable var="record" value="{!orderDetails.firmOrder}"/>
                                                                        <apex:variable var="isDisplayDate" value="{!AND('Production' == role,
                                                                                OR( record['SPO_FirmOrderStatus__c'] =='Distribution in progress',
                                                                                record['SPO_FirmOrderStatus__c'] =='Production in progress',record['SPO_FirmOrderStatus__c'] =='Cancelled by store',record['SPO_FirmOrderStatus__c'] =='Creation in progress'),orderDetailIsInEditSection
                                                                                )
                                                                                }"/>
                                                                        <tr>
                                                                            <td style="cursor: pointer;" data-toggle="collapse" data-target="#{!record['Id']}" class="accordion-toggle">
                                                                                <span class="caret caret-md"></span>
                                                                            </td>
                                                                            <td>{!record['SPO_FirmOrderNumber__c']}</td>
                                                                            <td width="20%">
                                                                                <c:SO_BootstrapDatePicker rendered="{!isDisplayDate}" >
                                                                                    <apex:inputText styleClass="revisedDateCLS" value="{!orderDetails.dateInStringType}" />
                                                                                </c:SO_BootstrapDatePicker>
                                                                                
                                                                                <apex:outputText rendered="{!NOT(isDisplayDate)}"  value="{!orderDetails.dateInStringType}"/>
                                                                            </td>
                                                                            <td>{!record['SPO_FirmOrderStatus__c']}</td>
                                                                            <td>{!record['SPO_Substatus__c']}</td>
                                                                            <td>

                                                                                <apex:commandButton value="{! $Label.LV_SO_Start_Production }" 
                                                                                    styleClass="btn btn-default margin-left followUpButton"
                                                                                    rendered="{! AND('Production' == role, CONTAINS('Creation in progress;In progress', Opportunity.StageName), AND( record['SPO_FirmOrderStatus__c'] == 'Creation in progress', OR(record['SPO_Substatus__c'] == 'Codification', record['SPO_Substatus__c'] == 'Technical data')) ) }"
                                                                                    action="{! foStartProduction }" 
                                                                                    reRender="followUp, OpportunityHistory, messagesPanelId"
                                                                                    onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                                    oncomplete="buildMixHistoryForEachFirmOrderFunction(); changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');">
                                                                                    
                                                                                    <apex:param value="{! record.Id }" name="currentFirmOrderId" assignTo="{! currentFirmOrderId }" />
                                                                                </apex:commandButton>

                                                                                <apex:commandButton value="{! $Label.LV_SO_Launch_QA }" 
                                                                                    styleClass="btn btn-default margin-left followUpButton"
                                                                                    rendered="{! AND('Production' == role, CONTAINS('Creation in progress;In progress', Opportunity.StageName), record['SPO_FirmOrderStatus__c'] == 'Production in progress', record['SPO_Substatus__c'] == NULL) }"
                                                                                    action="{! launchQA }" 
                                                                                    reRender="followUp, OpportunityHistory, messagesPanelId" 
                                                                                    onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                                    oncomplete="buildMixHistoryForEachFirmOrderFunction(); changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');">
                                                                                    
                                                                                    <apex:param value="{! record.Id }" name="currentFirmOrderId" assignTo="{! currentFirmOrderId }" />
                                                                                </apex:commandButton>

                                                                                <apex:commandButton value="{! $Label.LV_SO_ReceivedInStore }" 
                                                                                    styleClass="btn btn-default margin-left followUpButton"
                                                                                    rendered="{! AND('Production' != role, CONTAINS('In progress', Opportunity.StageName), record['SPO_FirmOrderStatus__c'] == 'Distribution in progress', record['SPO_Substatus__c'] == 'Sent to store', !displayOrder) }"
                                                                                    action="{! receivedInStore }" 
                                                                                    reRender="followUp, OpportunityHistory, messagesPanelId" 
                                                                                    onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                                    oncomplete="buildMixHistoryForEachFirmOrderFunction(); changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');">
                                                                                    
                                                                                    <apex:param value="{! record.Id }" name="currentFirmOrderId" assignTo="{! currentFirmOrderId }" />
                                                                                </apex:commandButton>

                                                                                <apex:commandButton value="{! $Label.LV_SO_SendToRMS }" 
                                                                                    styleClass="btn btn-default margin-left followUpButton"
                                                                                    rendered="{! AND('Production' != role, CONTAINS('In progress', Opportunity.StageName), record['SPO_FirmOrderStatus__c'] == 'Received in store', record['SPO_Substatus__c'] == NULL, !displayOrder) }"
                                                                                    action="{! sendToRMS }" 
                                                                                    reRender="followUp, OpportunityHistory, messagesPanelId" 
                                                                                    onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                                    oncomplete="buildMixHistoryForEachFirmOrderFunction(); changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');">
                                                                                    
                                                                                    <apex:param value="{! record.Id }" name="currentFirmOrderId" assignTo="{! currentFirmOrderId }" />
                                                                                </apex:commandButton>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="5" class="hiddenRow">
                                                                                <div class="accordian-body collapse" id="{!record['Id']}">
                                                                                    <table class="table table-hover table-striped">
                                                                                        <thead>

                                                                                            <tr>
                                                                                                <th>{!$ObjectType.SPO_FirmOrder__History.fields.CreatedDate.Label}</th>
                                                                                                <th>{!$ObjectType.OpportunityHistory.fields.StageName.Label}</th>
                                                                                                <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_FirmOrderStatus__c.Label}</th>
                                                                                                <th>{!$ObjectType.SPO_FirmOrder__c.fields.SPO_Substatus__c.Label}</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <tbody>
                                                                                            <apex:repeat value="{!firmOrderHistoryByFirmOrderIdMap[record['Id']]}" var="orderDetailHistory">
                                                                                                <tr>
                                                                                                    <td>
                                                                                                        <apex:outputField value="{!orderDetailHistory.firmOrderSubStatusHistory.CreatedDate}"/>
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        {!orderDetailHistory.oppHistory.StageName}
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        {!orderDetailHistory.firmOrderStatusHistory.NewValue}
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        {!orderDetailHistory.firmOrderSubStatusHistory.NewValue}
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </apex:repeat>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                    </apex:repeat>
                                                                    
                                                                </tbody>
                                                            </table>
                                                            <apex:outputPanel layout="none" rendered="{!AND(role == 'Production', CONTAINS('Creation in progress;In progress', Opportunity.StageName))}" >
                                                                <apex:commandButton rendered="{!orderDetailIsInEditSection}" 
                                                                value="{!$Label.LV_SO_Save}" 
                                                                styleClass="btn btn-success pull-right margin-left followUpButton" 
                                                                action="{!saveDateEdit}" 
                                                                reRender="messagesPanelId, followUp"
                                                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                oncomplete="unblockUI();"/>
                                                                <apex:commandButton rendered="{!NOT(orderDetailIsInEditSection)}" 
                                                                value="{!$Label.LV_SO_Edit}" 
                                                                styleClass="btn btn-success pull-right margin-left followUpButton" 
                                                                action="{!orderDetailEditMode}" 
                                                                reRender="messagesPanelId, followUp"
                                                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                                                oncomplete="unblockUI();">
                                                                </apex:commandButton>
                                                            </apex:outputPanel>                                                            
                                                        </div>
                                                    </div>
                                                </article>
                                                <apex:actionFunction name="buildMixHistoryForEachFirmOrderFunction" reRender="followUp, OpportunityHistory" action="{!buildMixHistoryForEachFirmOrder}" oncomplete="changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); unblockUI();"/>
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <!-- OpportunityHistory -->
                                        <apex:outputPanel id="OpportunityHistory">
                                            <apex:outputPanel rendered="true">
                                                <article class="panel panel-primary">
                                                    <div class="panel-heading">{!$Label.LV_SO_OpportunityHisotry}</div>
                                                    <div class="panel-body">
                                                        <div class="table-responsive">
                                                            <table class="table table-hover table-striped">
                                                                <thead>
                                                                    <th>{!$ObjectType.OpportunityHistory.fields.CreatedDate.Label}</th>
                                                                    <th>{!$Label.LV_SO_CreateBy}</th>
                                                                    <th>{!$ObjectType.OpportunityHistory.fields.StageName.Label}</th>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:repeat value="{!opportunityHistoryList}" var="oppHistory">
                                                                        <tr>
                                                                            <td><apex:outputField value="{!oppHistory.CreatedDate}"/></td>
                                                                            <td>{!oppHistory.CreatedBy.Name}</td>
                                                                            <td>{!oppHistory.StageName}</td>
                                                                        </tr>
                                                                    </apex:repeat>
                                                                    
                                                                </tbody>
                                                                
                                                            </table>
                                                        </div>

                                                    </div>
                                                </article>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                </div>
                            </div>

                            <!-- <apex:actionFunction name="cancelBrief" action="{!cancelBrief}" oncomplete="goToChoosePath()" /> -->
                            

                            <apex:outputPanel id="_renderedButtons_" layout="block">
                                <apex:actionStatus onstart="console.log('started');" onstop="console.log('stopped');" id="actionSection" rendered="_renderedButtons_, formToRerender" />



                                <apex:commandbutton value="{!$Label.LV_SO_Cloning}" styleclass="btn btn-default" action="{!cloning}" status="actionSection" rendered="{! 'Production' != role }"
                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}" oncomplete="unblockUI();" rerender="messagesPanelId"/>

                                <!-- Store cancel brief:  Brief in progress;Quotation submitted-->
                                <!-- Production reject quotation:  Quotation submitted-->
                                <!-- <apex:outputPanel style="display: {!IF(OR(AND(CONTAINS('Brief in progress;Quotation in progress;Quotation submitted;Quotation rejected;Quotation accepted;Deposit sent;Creation in progress', Opportunity.StageName), role != 'Production'), AND(role == 'Production', CONTAINS('Brief in progress;Quotation in progress', Opportunity.StageName))), '', 'none')}"> -->
                                <apex:outputPanel style="display: {!IF(hasCancelButton, '', 'none')}">
                                    <a href="" id=""  class="btn btn-warning margin-left cancelRejectQuatation">
                                        {! IF('Production' != role, $Label.LV_SO_PRODUCT_cancel_brief, $Label.LV_SO_Reject_Quotation) }
                                    </a>
                                </apex:outputPanel>
                                <!-- Normal Flow -->

                                <apex:actionFunction action="{!refreshOpportunityHistoryList}" name="refreshOpportunityHistoryList" reRender=" OpportunityHistory" oncomplete="unblockUI();" />

                                <apex:commandButton value="{!$Label.LV_SO_Request_quotation}" 
                                styleClass="btn btn-success margin-left pull-right"
                                rendered="{! AND(hasQuotation, Opportunity.StageName == 'Brief in progress', role != 'Production') }"
                                action="{!requestQuotation}" 
                                status="actionSection" 
                                reRender="formToRerender,OpportunityHistory, messagesPanelId" 
                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}"
                                oncomplete="init(); initPage(); changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList();"/>

                                <!-- Create Quotation: Production role -->
                                <apex:commandButton value="{! $Label.LV_SO_Create_Quotation }" 
                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;} if (!mainFormValidate()) {unblockUI(); return false; } " 
                                styleClass="btn btn-success margin-left pull-right"
                                rendered="{! AND(hasQuotation, Opportunity.StageName == 'Quotation in progress', 'Production' == role) }"
                                action="{!createQuotation}" 
                                status="actionSection" 
                                rerender="pricesAndDatePanelId, quotationInProgress, _renderedButtons_, OpportunityHistory, messagesPanelId" 
                                oncomplete="initPage(); changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList(); changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');"/>

                                <!-- Save/Update Quotation: Production role -->
                                <apex:outputPanel rendered="{!isEditMode}">
                                    <button type="button" class="btn btn-success margin-left pull-right" onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;} if (!mainFormValidate()) {unblockUI(); return false;} updateQuotationFunction();">{!$Label.LV_SO_Save_Quotation}</button>
                                    <apex:actionFunction name="updateQuotationFunction" action="{!updateQuotation}" 
                                    reRender="pricesAndDatePanelId, quotationInProgress, _renderedButtons_, OpportunityHistory, messagesPanelId" 
                                    oncomplete="initPage(); changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList();" />
                                </apex:outputPanel>

                                <apex:commandButton value="{! $Label.LV_SO_Edit_Quotation }" 
                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;} if (!mainFormValidate()) {unblockUI(); return false;}"
                                styleClass="btn btn-success margin-left pull-right"
                                rendered="{! AND(NOT(isEditMode), hasQuotation, role == 'Production', !CONTAINS('Brief in progress;Quotation in progress;Deposit sent;Creation in progress;In progress;Payment confirmed;Cancelled by store;Cancelled by Production;Closed Won', Opportunity.StageName)) }"
                                action="{!editQuotation}" 
                                status="actionSection" 
                                rerender="pricesAndDatePanelId, quotationInProgress, _renderedButtons_, OpportunityHistory" 
                                oncomplete="changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList(); rerender_CurrencyExportPrice();"
                                immediate="true"/>

                                <apex:commandButton value="{!$Label.LV_SO_Confirm_quotation}" 
                                styleclass="btn btn-success margin-left pull-right"
                                rendered="{! AND(hasQuotation, Opportunity.StageName == 'Quotation submitted', role != 'Production') }"
                                action="{!acceptQuotation}" 
                                status="actionSection" 
                                reRender="quotationAccepted, _renderedButtons_, OpportunityHistory, messagesPanelId" 
                                onclick="blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;}" 
                                oncomplete="oncompleteConfirmQuotation(); changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList();"/>

                                <apex:commandButton id="addDepositButtonId" value="{! IF(!displayOrder, $Label.LV_SO_Add_Deposit, $Label.LV_SO_SendToProduction) }" 
                                onclick=" blockUI(); if (!validateIfReadAllMessages()) {unblockUI(); return false;} if ($('#Opportunity__SPO_DueAmount__c').val() && !mainFormValidate()) {unblockUI(); return false;}" 
                                styleClass="btn btn-success margin-left pull-right"
                                rendered="{! OR(AND(!hasQuotation, Opportunity.StageName == 'Brief in progress', role != 'Production'), AND(role != 'Production', 'Quotation accepted' == Opportunity.StageName)) }"
                                action="{! addDeposit }" 
                                status="actionSection" 
                                reRender="pricesAndDatePanelId, quotationAccepted, followUp, _renderedButtons_, messagesPanelId, OpportunityHistory" 
                                oncomplete="onCompleteDepositButton();"/>

                                <apex:commandButton value="{! $Label.LV_SO_Send_to_Referential }" 
                                onclick="blockUI(); isSendToRef = true; if (!validateIfReadAllMessages()) {unblockUI(); return false;} if (!mainFormValidate()) {unblockUI(); return false;}"
                                styleClass="btn btn-success margin-left pull-right"
                                rendered="{! AND('Production' == role, AND(clickedOnSendToReferential == false, OR('Creation in progress' == Opportunity.StageName, 'Deposit sent' == Opportunity.StageName)))}"
                                action="{! sendToReferential }" 
                                status="actionSection" 
                                reRender="followUp, _renderedButtons_, ManufacturingSectionPanelId, OpportunityHistory, messagesPanelId, QoutationSection_CRS_FieldId"
                                oncomplete="
                                if ({! !showMessageOnTop })
                                {
                                    buildMixHistoryForEachFirmOrderButtonsFunction(); 
                                    if('{!isShowFirmOrderSection}' == 'false' && '{!Opportunity.StageName}' == 'Creation in progress')
                                    { 
                                        changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');
                                    }
                                    oncompleteReferentalSection();
                                }
                                else
                                {
                                    unblockUI();
                                }"
                                />

                                <apex:commandButton id="createERP" 
                                rendered="{! AND('Production' == role, AND(clickedOnCreateOrderInERP == false, OR('Creation in progress' == Opportunity.StageName, 'Deposit sent' == Opportunity.StageName)))}"
                                value="{! $Label.LV_SO_Create_order_in_ERP }" 
                                onclick="blockUI(); isCreateERP = true; if (!validateIfReadAllMessages()) {unblockUI(); isCreateERP = false; return false;}; if (!mainFormValidate()) {unblockUI(); isCreateERP = false; return false;}; isCreateERP = false;" 
                                styleClass="btn btn-success margin-left pull-right" 
                                action="{! createOrderInERP }" 
                                status="actionSection" 
                                reRender="followUp, _renderedButtons_, ManufacturingSectionPanelId, OpportunityHistory, messagesPanelId, QoutationSection_CRS_FieldId" 
                                oncomplete="
                                if ({! !showMessageOnTop })
                                {
                                    buildMixHistoryForEachFirmOrderButtonsFunction();
                                    changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');
                                    oncompleteReferentalSection();
                                }
                                else
                                {
                                    unblockUI();
                                }" 
                                />

                                <apex:actionFunction name="buildMixHistoryForEachFirmOrderButtonsFunction" reRender="followUp" action="{!buildMixHistoryForEachFirmOrder}" oncomplete="assignReadOnly({!isReadonlyMode}, '{!Opportunity.StageName}', {!clickedOnCreateOrderInERP}, {!clickedOnSendToReferential}); changeOppStageInBreadCrumbForBriefOrder('{!Opportunity.StageName}'); refreshOpportunityHistoryList();"/>

                                <apex:outputPanel rendered="{! !CONTAINS('Cancelled by store;Cancelled by Production;Closed Won', Opportunity.StageName)}">
                                    <button type="button" class="btn btn-success margin-left pull-right" onclick="blockUI(); isSaveBrief = true; isCreateERP = true; if (!validateIfReadAllMessages()) {unblockUI(); isSaveBrief = false; isCreateERP = false; return false;} if (!mainFormValidate()) {unblockUI(); isSaveBrief = false; isCreateERP = false; return false;} isSaveBrief = false; isCreateERP = false; updateBriefFunction();">{!$Label.LV_SO_SaveBrief}</button>
                                    <apex:actionFunction name="updateBriefFunction" action="{!updateBrief}" 
                                    reRender="_renderedButtons_, messagesPanelId" 
                                    oncomplete="unblockUI();" />
                                </apex:outputPanel>

                                <apex:outputPanel rendered="{!'Production' != role}">
                                    <a href='' id=""  class="btn btn-default margin-left pull-right exportPdf">
                                        {!$Label.LV_SO_Export_as_PDF}
                                    </a>
                                </apex:outputPanel>

                            </apex:outputPanel>

                    </div>
                </div>
            </apex:form>
        </apex:define>
    </apex:composition>
    <script type="text/javascript">
        var __sfdcSessionId = '{!GETSESSIONID()}';
    </script>
    <script src="/soap/ajax/34.0/connection.js" type="text/javascript"/>
    
    <script>

        $(document).on("click",'.exportPdf', function(e)
        {

            if (validateIfReadAllMessages()) {
                $.magnificPopup.open({
                  items: {
                    src: '#pdf_brief_dialog',
                    type: 'inline'
                  }
                });
            }


        });

        $('.cancelRejectQuatation').click(function()
        {
            if (validateIfReadAllMessages()) 
            {
                $('.cancelRejectQuatation').attr('id','openCancelBrief');
                $('.cancelRejectQuatation').attr('href','#cancel_brief_dialog');
            }
            else
            {
                $('.cancelRejectQuatation').removeAttr('id');
                $('.cancelRejectQuatation').removeAttr('href');
            }
        })

        var currentRole = '{!role}';
        var isDepositAmountPayment = {!isDepositAmountPayment};
        function isDepositAmountDefultValue()
        {
            
            var depositAmount = $('[id$="formToRerender:SPO_DepositAmount_InputFieldId"]');
            var totalAmount = $('[id$="pricesForm_SPO_TotalAmount__c"]').val();
            if(depositAmount.size() > 0)
            {
                if(isDepositAmountPayment)
                {
                    depositAmount.val(totalAmount/2);
                }
                else
                {
                    depositAmount.val(0);
                }
            }
        }

        function depositCalculations()
        {
            //var unitRetailPrice = {! BLANKVALUE(IF(hasQuotation, Opportunity.SPO_UnitRetailPriceQuotation__c, Opportunity.SPO_UnitRetailPrice__c), 0) };
            var unitRetailPrice = 0;
            var hasQuotation = {!hasQuotation};

            $('[id$="pricesForm_SPO_SkuQuantity__c"]').keyup(function () 
            {
                if(true === hasQuotation)
                {
                    unitRetailPrice = {!BLANKVALUE(Opportunity.SPO_UnitRetailPriceQuotation__c, 0)};
                }
                else
                {
                    unitRetailPrice = $('[id*="SPO_UnitRetailPriceId"]').val() != '' ? $('[id*="SPO_UnitRetailPriceId"]').val() : 0;
                }

                if(!$('[id$="freeCheckbox"]').is(':checked'))
                {
                    var totalAmount = (parseFloat(this.value) || 0) * unitRetailPrice;
                    $('[id$="pricesForm_SPO_TotalAmount__c"]').val(totalAmount.toFixed(2));
                    $('[id$="totalAmountAndCurr"]').val($('[id$="pricesForm_SPO_TotalAmount__c"]').val() + ' ' + '{!Opportunity.SPO_StoreCurrency__c}');

                    isDepositAmountDefultValue();
                    $('[id$="Opportunity__SPO_DueAmount__c"]').val( (totalAmount - (parseFloat($('[id$="SPO_DepositAmount_InputFieldId"]').val()) || 0)).toFixed(2) + ' {!Opportunity.SPO_StoreCurrency__c}' );
                }

                requiredComment();
            });

            $('[id$="SPO_DepositAmount_InputFieldId"]').keyup(function () 
            {
                if(!$('[id$="freeCheckbox"]').is(':checked'))
                {
                    $('[id$="Opportunity__SPO_DueAmount__c"]').val( ((parseFloat($('[id$="pricesForm_SPO_TotalAmount__c"]').val()) || 0) - (parseFloat(this.value) || 0)).toFixed(2) + ' {!Opportunity.SPO_StoreCurrency__c}' );
                }
                else
                {
                    this.value = 0;
                }
            });
        }

        function oncompleteConfirmQuotation()
        {
            try
            {
                isDepositAmountDefultValue();
                depositCalculations();
                requiredComment();
                calculateInitDueAmount();
            }
            catch(e)
            {
                console.debug(e);
            }
        }

        function calculateInitDueAmount()
        {
            $('[id$="Opportunity__SPO_DueAmount__c"]').val( ((parseFloat( $('[id$="pricesForm_SPO_TotalAmount__c"]').val() ) || 0) - (parseFloat( $('[id$="SPO_DepositAmount_InputFieldId"]').val() ) || 0)).toFixed(2) + ' {!Opportunity.SPO_StoreCurrency__c}');
        }

        function parseNum(a) { return (+a) || ('' !== a) && !!+a; }

        var isSendToRef = false;
        var isCreateERP = false;
        var isSaveBrief = false;

        $(window).load(function()
        {
            init();

            $.validator.addMethod("manufacturingRequired", function(value, element) 
            {
                if(typeof isCreateERP != 'undefined' && isCreateERP == true)
                {
                    return $.validator.methods.required.call(this, value, element);
                }

                return true;
            }, $.validator.messages.required);
        });

        function requiredComment()
        {
            if($('[id*="comentFieldReadOnly"]').size() == 0  
                && $('[id*="SPO_DepositAmount_InputFieldId"]').size() != 0)
            {
                var depositAmount = 0;
                try
                {
                    depositAmount = Number($('[id*="SPO_DepositAmount_InputFieldId"]').val().trim());
                }
                catch(e)
                {
                    depositAmount = 0;
                    $('[id*="SPO_DepositAmount_InputFieldId"]').val(depositAmount);
                }

                if(isNaN(depositAmount))
                {
                    depositAmount = 0;
                    $('[id*="SPO_DepositAmount_InputFieldId"]').val(depositAmount);
                }

                if(!depositAmount || depositAmount == '' || depositAmount == 0){
                    $('#depositComment').removeClass().addClass('form-group required');
                    $('[id*="comentField"]').data('rule-required', true); 
                    $('[id*="comentField"]').attr('data-rule-required', true);
                }
                else{
                    $('#depositComment').removeClass().addClass('form-group');
                    $('[id*="comentField"]').data('rule-required', false); 
                    $('[id*="comentField"]').attr('data-rule-required', false);
                    $('[id*="comentField"]').next().hide();
                }
            }

        }

        function initDepositCalculations()
        {
            try
            {
                var a = parseNum($('[id$="SPO_DepositAmount_InputFieldId"]').val());
                if(false !== a) {
                    $('[id$="SPO_DepositAmount_InputFieldId"]').removeClass('required');
                }

                isDepositAmountDefultValue();
                depositCalculations();
                calculateInitDueAmount();
            }
            catch(e)
            {
                console.debug(e);
            }
        }

        var jsonRMSPriceData = [];
        function initUnitRetailPriceRMS()
        {
            var hasQuotation = {!hasQuotation};
            var isValidForPriceCall = {!isValidForPriceCall};
            //SPO_StoreCode__c, SPO_BaseSku__c
            var storeCode = '{!Opportunity.SPO_StoreCode__c}';
            var baseSKU = '{!Opportunity.SPO_BaseSku__c}';
            if(false === hasQuotation && true == isValidForPriceCall)
            {

                var blockUIOptions = 
                {         
                    message: '<img src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/0.16.1/images/loader-small-inverted.gif" />',
                    overlayCSS: 
                    {
                        backgroundColor: 'black',
                        cursor: 'wait'
                    },
                    css: 
                    {
                        border: 'border:solid 1px #a0a0a0',
                        padding: '8px',
                        backgroundColor: 'transparent',
                        '-webkit-border-radius': '10px',
                        '-moz-border-radius': '10px',
                        opacity: .5,
                        color: '#000'
                    }
                };

                $('.priceBody').block(blockUIOptions);
                $('.depositBody').block(blockUIOptions);
                $('[id$="addDepositButtonId"]').hide();

                var unitRetailPriceValue = $('[id*="SPO_UnitRetailPriceId"]').val() != '' && String($('[id*="SPO_UnitRetailPriceId"]').val()) != 'undefined' ? $('[id*="SPO_UnitRetailPriceId"]').val() : 0;
                SO_BriefOrder_CTRL.remoteRetreiveArticleRMSPrice(unitRetailPriceValue, storeCode, baseSKU, function(result, event)
                {
                    if(event.status)
                    {                       
                        //jsonRMSPriceData = [];
                        if(result != '') 
                        {
                            jsonRMSPriceData = JSON.parse(result);
                            if(true === jsonRMSPriceData.isValid)
                            {
                                onCompleteUnitRetailPriceRMS();
                            }
                            else
                            {
                                showFillFieldsErrorWithCustomMessage(true, jsonRMSPriceData.errorCode + ': ' + jsonRMSPriceData.errorMessage);
                            }
                        }
                    }
                },
                {
                    escape:false
                });
            }
        }

        function onCompleteUnitRetailPriceRMS()
        {
            // 03/10/2016 MTOU: adding 20% on retail price for VgV
            //var interiorMaterial = '{!Opportunity.SPO_LiningInteriorMaterial1__c}';
            //var processOrder = '{!Opportunity.SPO_OrderType__c}';
            if($(jsonRMSPriceData).size() > 0)
            {
                // Begin MTOU
                $('[id*="SPO_UnitRetailPriceId"]').val(jsonRMSPriceData.unitRetailPrice);
               
                //$('#rmsArticlePriceToDisplayNoQuotationId').val(jsonRMSPriceData.unitRetailPrice.toFixed(jsonRMSPriceData.numberOfDecimalsStore) + $('#rmsArticlePriceToDisplayNoQuotationId').val());
                $('#rmsArticlePriceToDisplayNoQuotationId').val(jsonRMSPriceData.unitRetailPrice.toFixed(jsonRMSPriceData.numberOfDecimalsStore) + ' ' + '{!Opportunity.SPO_StoreCurrency__c}');
                // end MTOU
                $('[id$="SPO_NumberOfDecimalsStoreId"]').val(jsonRMSPriceData.numberOfDecimalsStore);
                $('[id$="pricesForm_SPO_SkuQuantity__c"]').keyup();
                $('[id$="SPO_DepositAmount_InputFieldId"]').keyup();
                $('.priceBody').unblock();
                $('.depositBody').unblock();
                $('[id$="addDepositButtonId"]').show();
            }
        }

        function onCompleteDepositButton()
        {
            depositCalculations(); 
            requiredComment();

            if($('[id$=messagesPanelId]').text().trim() == '')
            { 
                buildMixHistoryForEachFirmOrderButtonsFunction(); 
                changeBreadcrumpIconsAfterStageChange('{!icons.tabClientIcon}', '{!icons.tabProductIcon}', '{!icons.tabBriefOrderIcon}');
            }
            else 
            {                
                onCompleteUnitRetailPriceRMS();
                picklistCTRL.init('SPO_SpecialEvents_InputField', '', 'true', '');
                unblockUI();
            }
        }

        var isLG    = {!oppLeatherGood == opp.SPO_ProductCategory__c};
        var isWatch = {!oppWatch == opp.SPO_ProductCategory__c};
        var isAcc   = {!oppAccessory == opp.SPO_ProductCategory__c};
        

        function init()
        {
            initUnitRetailPriceRMS();

            dependentCTRL.init('Opportunity');

            initDepositCalculations(); 

            picklistCTRL.init('SPO_MarketingApproval_InputField', '', 'true', '');
            picklistCTRL.init('SPO_CentralApproval_InputField', '', 'true', '');
            picklistCTRL.init('SPO_ZoneApproval_InputField', '', 'true', '');

            picklistCTRL.init('SPO_SpecialEvents_InputField', '', 'true', '');
            picklistCTRL.init('SPO_RefueQuotationReason_InputField', '', 'true', '');
            picklistCTRL.init('SPO_Gender_InputField', '', '', isLG.toString());

            picklistCTRL.init('SPO_MadeIn_InputField', '', '', (isLG || isWatch || isAcc).toString());
            picklistCTRL.init('SPO_ManuFacturerProcess_InputField', '', '', isLG.toString());
            picklistCTRL.init('SPO_MarketingColor_InputField', '', '', isLG.toString());
            // picklistCTRL.init('SPO_WristSize_InputField', '', '', '');
            picklistCTRL.init('SPO_SalesType_InputField', '', '', isLG.toString());

            picklistCTRL.init('SPO_GroupAccWatch_InputField',     '', 'true', '');
            picklistCTRL.init('SPO_SubFamilyWatchAcc_InputField', '', 'true', '');
            picklistCTRL.init('SPO_StrapMaterialSAP_InputField', '', 'true', isWatch.toString());
            picklistCTRL.init('SPO_FamilyWatchAcc_InputField',    '', 'true', '');
            
            picklistCTRL.init('SPO_Department_InputField',        '', 'true', isLG.toString());
            picklistCTRL.init('SPO_GroupLG_InputField',           '', 'true', 'true');
            picklistCTRL.init('SPO_CreationType_InputField',      '', 'true', '');
            picklistCTRL.init('SPO_MainGroupLG_InputField',       '', 'true', '');
            picklistCTRL.init('SPO_SubAestheticline_InputField',  '', 'true', isLG.toString());
            picklistCTRL.init('SPO_SubDepartment_InputField',     '', 'true', '');
            picklistCTRL.init('SPO_SubGroup_InputField',          '', 'true', isLG.toString());

            picklistCTRL.init('SPO_ItemDimensionGroupAcc_InputField',   '', '', '');
            picklistCTRL.init('SPO_MainGroupAccWa_InputField',          '', '', '');
            picklistCTRL.init('SPO_StrapColor_InputField',              '', '', '');
            picklistCTRL.init('SPO_StrapMainMaterial_InputField',       '', '', '');
            picklistCTRL.init('SPO_MacroFamilyWatchAcc_InputField',     '', '', '');
            picklistCTRL.init('SPO_Activity2_InputField',               '', '', '');
            //dependentCTRL.buildBootstrapDropdown('SPO_Department__c', 'SPO_Activity2__c', '{!currentRecordTypeName}', 'SPO_Department_InputField', 'SPO_Activity2_InputField', '{!$Label.LV_SO_None}');
            picklistCTRL.init('SPO_FamilyLG_InputField',                '', '', '');
            picklistCTRL.init('SPO_Item_DimensionGroupLG_InputField',   '', '', '');
            picklistCTRL.init('SPO_MainMaterialSAP_InputField',       '', 'true', isLG.toString());
            picklistCTRL.init('SPO_MacroFamilyLG_InputField',           '', '', '');
            picklistCTRL.init('SPO_Aestheticline_InputField',           '', '', '');
            picklistCTRL.init('SPO_ItemDimensionGroupWatch_InputField', '', '', '');
            picklistCTRL.init('SPO_SubFamilyLG_InputField',             '', '', '');
            // picklistCTRL.init('SPO_MacroMaterial_InputField',           '', '', '');
            dependentCTRL.buildBootstrapDropdown('SPO_MainMaterialSAP__c', 'SPO_MacroMaterial__c', '{!currentRecordTypeName}', 'SPO_MainMaterialSAP_InputField', 'SPO_MacroMaterial_InputField', '{!$Label.LV_SO_None}');
            /*dependentCTRL.buildBootstrapDropdown('SPO_SubGroup__c', 'SPO_Item_DimensionGroupLG__c', '{!currentRecordTypeName}', 'SPO_SubGroup_InputField', 'SPO_Item_DimensionGroupLG_InputField', '{!$Label.LV_SO_None}');
            dependentCTRL.buildBootstrapDropdown('SPO_SubGroup__c', 'SPO_ItemDimensionGroupWatch__c', '{!currentRecordTypeName}', 'SPO_SubGroup_InputField', 'SPO_ItemDimensionGroupWatch_InputField', '{!$Label.LV_SO_None}');
            dependentCTRL.buildBootstrapDropdown('SPO_SubGroup__c', 'SPO_ItemDimensionGroupAcc__c', '{!currentRecordTypeName}', 'SPO_SubGroup_InputField', 'SPO_ItemDimensionGroupAcc_InputField', '{!$Label.LV_SO_None}');*/
            picklistCTRL.init('SPO_CurrencyExportPrice_InputField', '', '', 'true');




            checkStatus();
            initFormValidation();

            // if('{!Opportunity.StageName}' == 'Creation in progress' && '{!isShowFirmOrderSection}' == 'false')
            // {
            //     $('[id*=createERP]').show();
            // }

            requiredComment();
            var stageNameStr = '{!Opportunity.StageName}';
            if($('.cancelRejectQuatation').size() > 0 && (stageNameStr == 'Cancelled by Production' || stageNameStr == 'Cancelled by store')){
                $('.cancelRejectQuatation').click();
            }

            setReferentialPicklistsAllDefaultValues();

            if({!isShowFirmOrderSection} == true)
            {
                oncompleteReferentalSection();
            }
        }

        function oncompleteReferentalSection()
        {
            $('[id$="referentialSectionId"] .form-group.required').removeClass().addClass('form-group');
        }

        function setReferentialPicklistsDefaultValues(selectFieldUniqueName)
        {
            //$('#SPO_GroupLG_InputFieldDropDownId a[value != ""]').size()
            if($('#' + selectFieldUniqueName + 'DropDownId a[value != ""]').size() == 1)
            {
                $('#' + selectFieldUniqueName + 'DropDownId a[value != ""]').click();
                $('#' + selectFieldUniqueName + 'ButtonId').attr('disabled', 'true');
                $('#' + selectFieldUniqueName + 'ButtonId').closest('.form-group.required').removeClass().addClass('form-group');
            }
        }

        // 02/11/2016 - Added by MTOU
        function setReferentialPicklistsDefaultValuesForRequiredFields(selectFieldUniqueName)
        {
            if($('#' + selectFieldUniqueName + 'DropDownId a[value != ""]').size() == 1)
            {
                $('#' + selectFieldUniqueName + 'DropDownId a[value != ""]').click();
                $('#' + selectFieldUniqueName + 'ButtonId').attr('disabled', 'true');
            }
        }

        function setReferentialPicklistsAllDefaultValues()
        {
            /*setReferentialPicklistsDefaultValues('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_GroupAccWatch_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupAccWatch_InputField');
            setReferentialPicklistsDefaultValues('SPO_SubGroup_InputField');
            /*setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValues('SPO_FamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_StrapColor_InputField');
            setReferentialPicklistsDefaultValues('SPO_StrapMainMaterial_InputField');
            //setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
            //setReferentialPicklistsDefaultValues('SPO_Activity2_InputField');
            /*setReferentialPicklistsDefaultValues('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainMaterialSAP_InputField');
            //setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_Aestheticline_InputField');
            //setReferentialPicklistsDefaultValues('SPO_Activity2_InputField');
            /*setReferentialPicklistsDefaultValues('SPO_GroupAccWatch_InputField');
            setReferentialPicklistsDefaultValues('SPO_GroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupWatch_InputField');
            setReferentialPicklistsDefaultValues('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValues('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupAccWatch_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupWatch_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupAcc_InputField');
            //setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
            //setReferentialPicklistsDefaultValuesForRequiredFields('SPO_SalesType_InputFieldId');
        }

        function onCompleteSubFamilyLG() {
            picklistCTRL.init('SPO_SubFamilyLG_InputField',   '', '', '');
            picklistCTRL.init('SPO_GroupAccWatch_InputField', '', '', '');

            /*setReferentialPicklistsDefaultValues('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_GroupAccWatch_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupAccWatch_InputField');
        }
        function onCompleteSubGroup() {
            picklistCTRL.init('SPO_SubGroup_InputField', '', '', isLG.toString());
            setReferentialPicklistsDefaultValues('SPO_SubGroup_InputField');
        }
        function rerender_SPO_GroupAccWatch_dependands() {
            //picklistCTRL.init('SPO_ItemDimensionGroupAcc_InputField', '', '', '');
            picklistCTRL.init('SPO_MainGroupAccWa_InputField',        '', '', '');

            //setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupAcc_InputField');
            //setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupAccWa_InputField');
        }
        function rerender_SPO_SubFamilyWatchAcc_dependands() {
            picklistCTRL.init('SPO_FamilyWatchAcc_InputField',      '', 'true', '');
            picklistCTRL.init('SPO_MacroFamilyWatchAcc_InputField', '', '', '');

            /*setReferentialPicklistsDefaultValues('SPO_FamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
        }
        function rerender_SPO_StrapMaterialSAP_dependands() {
            picklistCTRL.init('SPO_StrapMainMaterial_InputField', '', '', '');

            setReferentialPicklistsDefaultValues('SPO_StrapMainMaterial_InputField');
        }
        function rerender_SPO_FamilyWatchAcc_dependands() {
            picklistCTRL.init('SPO_MacroFamilyWatchAcc_InputField', '', '', '');

            //setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
        }
        function rerender_SPO_Department_dependands() {
            //picklistCTRL.init('SPO_Activity2_InputField', '', '', '');
            //dependentCTRL.buildBootstrapDropdown('SPO_Department__c', 'SPO_Activity2__c', '{!currentRecordTypeName}', 'SPO_Department_InputField', 'SPO_Activity2_InputField', '{!$Label.LV_SO_None}'); --> deactivated by MTOU

            //setReferentialPicklistsDefaultValues('SPO_Activity2_InputField');
        }
        function rerender_SPO_GroupLG_dependands() {
            picklistCTRL.init('SPO_MainGroupLG_InputField',           '', 'true', '');
            picklistCTRL.init('SPO_FamilyLG_InputField',              '', '', '');
            //picklistCTRL.init('SPO_Item_DimensionGroupLG_InputField', '', '', '');
            picklistCTRL.init('SPO_MacroFamilyLG_InputField',         '', '', '');

            /*setReferentialPicklistsDefaultValues('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyLG_InputField');
            //setReferentialPicklistsDefaultValuesForRequiredFields('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
        }
        function rerender_SPO_MainMaterialSAP_dependands() {
            dependentCTRL.buildBootstrapDropdown('SPO_MainMaterialSAP__c', 'SPO_MacroMaterial__c', '{!currentRecordTypeName}', 'SPO_MainMaterialSAP_InputField', 'SPO_MacroMaterial_InputField', '{!$Label.LV_SO_None}');

            setReferentialPicklistsDefaultValues('SPO_MacroMaterial_InputField');
        }
        function rerender_SPO_MainGroupLG_dependands() {
            picklistCTRL.init('SPO_MacroFamilyLG_InputField', '', '', '');

            //setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
        }
        function rerender_SPO_SubAestheticline_dependands() {
            picklistCTRL.init('SPO_Aestheticline_InputField', '', '', '');

            setReferentialPicklistsDefaultValues('SPO_Aestheticline_InputField');
        }
        function rerender_SPO_SubDepartment_dependands() {
            picklistCTRL.init('SPO_Department_InputField', '', 'true', isLG.toString());
            //picklistCTRL.init('SPO_Activity2_InputField',  '', '', '');
            //dependentCTRL.buildBootstrapDropdown('SPO_Department__c', 'SPO_Activity2__c', '{!currentRecordTypeName}', 'SPO_Department_InputField', 'SPO_Activity2_InputField', '{!$Label.LV_SO_None}');--> deactivated by MTOU

            setReferentialPicklistsDefaultValues('SPO_Department_InputField');
            //setReferentialPicklistsDefaultValues('SPO_Activity2_InputField'); by MTOU
        }
        function rerender_SPO_SubGroup_dependands() {
            picklistCTRL.init('SPO_GroupAccWatch_InputField',           '', 'true', '');
            picklistCTRL.init('SPO_GroupLG_InputField',                 '', 'true', 'true');
            picklistCTRL.init('SPO_MainGroupLG_InputField',             '', 'true', '');
            picklistCTRL.init('SPO_ItemDimensionGroupWatch_InputField', '', '', '');
            picklistCTRL.init('SPO_SubFamilyLG_InputField',             '', '', '');
            picklistCTRL.init('SPO_ItemDimensionGroupAcc_InputField',   '', '', '');
            picklistCTRL.init('SPO_MainGroupAccWa_InputField',          '', '', '');
            picklistCTRL.init('SPO_FamilyLG_InputField',                '', '', '');
            picklistCTRL.init('SPO_Item_DimensionGroupLG_InputField',   '', '', '');
            picklistCTRL.init('SPO_MacroFamilyLG_InputField',           '', '', '');

            /*setReferentialPicklistsDefaultValues('SPO_GroupAccWatch_InputField');
            setReferentialPicklistsDefaultValues('SPO_GroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupWatch_InputField');
            setReferentialPicklistsDefaultValues('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValues('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValues('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValues('SPO_MacroFamilyLG_InputField');*/
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupAccWatch_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_GroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupWatch_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_SubFamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_ItemDimensionGroupAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MainGroupAccWa_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_FamilyLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_Item_DimensionGroupLG_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyLG_InputField');
        }
        function rerender_SPO_FamilyWatchAcc_dependands() {
            picklistCTRL.init('SPO_MacroFamilyWatchAcc_InputField', '', '', '');

            //setReferentialPicklistsDefaultValues('SPO_MacroFamilyWatchAcc_InputField');
            setReferentialPicklistsDefaultValuesForRequiredFields('SPO_MacroFamilyWatchAcc_InputField');
        }
        
        function rerender_CurrencyExportPrice() {
            picklistCTRL.init('SPO_CurrencyExportPrice_InputField',     '', '', 'true');
        }

       function freeClick()
       {

            if($('[id$="freeCheckbox"]').is(':checked'))
            {
                $('[id$="pricesForm_SPO_TotalAmount__c"]').val(0);
                $('[id$="totalAmountAndCurr"]').val($('[id$="pricesForm_SPO_TotalAmount__c"]').val() + ' ' + '{!Opportunity.SPO_StoreCurrency__c}');
                $('[id$="SPO_DepositAmount_InputFieldId"]').val(0);
                calculateInitDueAmount();
            }
            else
            {
                $('[id$="pricesForm_SPO_SkuQuantity__c"]').keyup();
            }
            requiredComment(); 
        }

        // function goToProductSpe(){
        //     window.location.href='/apex/SO_choosepath?id={!$CurrentPage.parameters.id}'; 
        //     return false;
        // }
        function goToChoosePath(){
            window.location.href='/apex/SO_choosepath'; 
            return false;
        }
        function goBackInHistory(){
            window.history.back(); 
            return false;
        }

        function assignReadOnly(isReadOnlyMode, StageName, clickedOnCreateOrderInERP, clickedOnSendToReferential)
        {
            var isReadonlyMode = isReadOnlyMode;
            var oneOfClosedStage = false;
            var showPaymentBtn = StageName == 'Payment confirmed'; 

            var closedStages = ['Quotation rejected', 'Payment confirmed', 'Closed Won', 'Cancelled by store', 'Cancelled by Production'];
            if (jQuery.inArray( StageName, closedStages ) >-1 && {!(contains('Store;Production',role))} ) {
                oneOfClosedStage = true;
            }

            if ( isReadonlyMode || oneOfClosedStage || clickedOnCreateOrderInERP || clickedOnSendToReferential) {
                setAllReadonly(clickedOnCreateOrderInERP, clickedOnSendToReferential);
                if (showPaymentBtn){
                    // show the payment buttons
                    $('form .paymentBtn').removeAttr('disabled');
                }

                $('.followUpButton').removeAttr('disabled');
               //revisedDateCLS
                $('.revisedDateCLS').removeAttr('disabled');

                $('#SPO_ZoneApproval_InputFieldButtonId').removeAttr('disabled');
                $('#SPO_CentralApproval_InputFieldButtonId').removeAttr('disabled');
                $('#SPO_MarketingApproval_InputField').removeAttr('disabled');

                if ((StageName == 'Creation in progress' || StageName == 'Deposit sent') && clickedOnCreateOrderInERP == false){
                    $('[id$="SPO_Manufacturing_OF_InputFieldId"]').removeAttr('disabled');
                    $('[id$="SPO_Manufacturing_CRS_InputFieldId"]').removeAttr('disabled');
                    $('.select2-input').removeAttr('disabled');
                    $("[id*='lookupMockValueId']").removeAttr('disabled');
                }
            }

            // if (StageName != 'Deposit sent' && {!contains('Production',role)}){
            //     $('[id$="referentialSectionId"] *').attr('disabled','');
            // }
        }

        function checkStatus(){
            var isReadonlyMode = {!isReadonlyMode};
            var oneOfClosedStage = false;
            var showPaymentBtn = '{!Opportunity.StageName}' == 'Payment confirmed'; 

            var closedStages = ['Quotation rejected', 'Payment confirmed', 'Closed Won', 'Cancelled by store', 'Cancelled by Production'];
            if (jQuery.inArray( '{!Opportunity.StageName}', closedStages ) >-1 && {!(contains('Store;Production',role))} ) {
                oneOfClosedStage = true;
            }

            if ( isReadonlyMode || oneOfClosedStage || {!clickedOnCreateOrderInERP} || {!clickedOnSendToReferential}) {
                setAllReadonly({!clickedOnCreateOrderInERP}, {!clickedOnSendToReferential});
                if (showPaymentBtn){
                    // show the payment buttons
                    $('form .paymentBtn').removeAttr('disabled');
                }

                $('.followUpButton').removeAttr('disabled');
                //revisedDateCLS
                $('.revisedDateCLS').removeAttr('disabled');

                $('#SPO_ZoneApproval_InputFieldButtonId').removeAttr('disabled');
                $('#SPO_CentralApproval_InputFieldButtonId').removeAttr('disabled');
                $('#SPO_MarketingApproval_InputField').removeAttr('disabled');

                if (('{!Opportunity.StageName}' == 'Creation in progress' || '{!Opportunity.StageName}' == 'Deposit sent') && {!clickedOnCreateOrderInERP} == false)
                {
                    $('[id$="SPO_Manufacturing_OF_InputFieldId"]').removeAttr('disabled');
                    $('[id$="SPO_Manufacturing_CRS_InputFieldId"]').removeAttr('disabled');
                    $('.select2-input').removeAttr('disabled');
                    $("[id*='lookupMockValueId']").removeAttr('disabled');
                }
            }

            // if ('{!Opportunity.StageName}' != 'Deposit sent' && {!contains('Production',role)}){
            //     $('[id$="referentialSectionId"] *').attr('disabled','');
            // }
        }

        function setAllReadonly(clickedOnCreateOrderInERP, clickedOnSendToReferential){
            var tagTypes = ['input','textarea','button'];
            // Set all the fields to read only  
            $.each(tagTypes, function(k,tag)
            {
                if(clickedOnSendToReferential == false)
                {
                    $('form .panel .panel-info ' + tag).not('#referentialSectionBody ' + tag).attr('disabled','');
                }
                else
                {
                    $('form .panel .panel-info ' + tag).attr('disabled','');
                }
            });

            $('[id$="caCodeId"]').removeAttr('disabled');
            $('[id$="quotationAccepted"] *').removeAttr('disabled');
        }

            function initFormValidation(){
                var form = $('[id$="formToRerender"]');
                form.validate();
            }

            function mainFormValidate(){
                var form = $('[id$="formToRerender"]');
                if(isCreateERP == true && isSaveBrief == false)
                {
                    form.validate().settings.ignore = ':hidden, #referentialSectionBody :input';
                }
                else
                {
                    form.validate().settings.ignore = ':hidden';
                }

                var isMainFormValid = form.valid();
                if(isMainFormValid){
                    showFillFieldsError(false);
                }else{
                    showFillFieldsError(true);
                }
                return isMainFormValid;
            }

            function validateIfReadAllMessages(){
                var read_messages_str = $('.messages').text();
                if(read_messages_str != '0'){
                    showFillFieldsErrorWithCustomMessage(true, '{!$Label.LV_SO_PleaseReadAllMessages}');
                    return false;
                }
                else{
                    showFillFieldsErrorWithCustomMessage(false, '');
                    return true;
                }
            }

            // PDF popup
            $(function(){
                var valid = false;
                $('#pdf_brief_dialog .dropDownOption').click(function(e){
                    $('#dropDownSelected').html('<span class="caret"></span>'+e.target.text);
                    $('#dropDownSelected').data('langcode',e.target.dataset.langcode);
                    if (e.target.text!='{!$Label.LV_SO_None}') {
                        $('#selectLanguageError').hide();
                        valid=true;
                    }else {
                        valid=false;
                        $('#selectLanguageError').show();
                    }
                });

                $('#pdf_brief_dialog').
                        find('#cancelExportPdf , .glyphicon-remove').
                            click(function () { $.magnificPopup.close(); }).
                        end().

                        find('#createPDF').
                            click(function () {
                                if (!valid) {
                                    $('#selectLanguageError').show();
                                    return;
                                }
                                var langcode = $('#dropDownSelected').data('langcode');
                                if (!langcode) langcode='en_US';
                                var url = '/apex/SO_BriefOrder_PDF?lang='+langcode+'&id={!$CurrentPage.parameters.id}';
                                window.open(url, '_blank');
                                $.magnificPopup.close();
                            }).
                        end();


                $(document).on("focusin", "#SPO_GroupLG_InputFieldbuttonid", function() {
                    console.log('in');
                   $(this).prop('readonly', true);  
                });

                $(document).on("focusout", "#SPO_GroupLG_InputFieldbuttonid", function() {
                    console.log('out');
                   $(this).prop('readonly', false); 
                });
            });

            $(window).load(function(){
                $('[id$=exportPricesIdInEdit]').removeAttr('disabled');
                $('[id*=UnitRetailPricesIdInEdit]').removeAttr('disabled');
            })
         
    </script>
</apex:page>