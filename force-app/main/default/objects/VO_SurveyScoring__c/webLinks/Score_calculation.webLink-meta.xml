<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Score_calculation</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Score calculation</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/27.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/27.0/apex.js&quot;)} 
var Id = &quot;{!VO_SurveyScoring__c.Id}&quot;; 
res = confirm(&quot;You are going to run the score refresh in surveys &quot; + &quot;{!VO_SurveyScoring__c.SurveyType__c}&quot; + &quot; from &quot; + &quot;{!VO_SurveyScoring__c.StartDate__c}&quot; + &quot; to &quot; + &quot;{!VO_SurveyScoring__c.EndDate__c}&quot;); 
if (res == true) { 
var result = sforce.apex.execute(&apos;VO_BatchSurveyScoring&apos;,&apos;startBatch&apos;,{scoreCalcId : Id, maxRecords : 1000}); 
if (result[0].substr(0,2) == &quot;KO&quot;) alert(result[0].substr(3,result.length - 3)); 
}</url>
</WebLink>
